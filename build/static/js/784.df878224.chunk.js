"use strict";(self.webpackChunkreact_gwapp=self.webpackChunkreact_gwapp||[]).push([[784],{823:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ni});var s=n(5043),i=n(5749),a=n(5756),r=n(8390),o=n(2203),l=n(5376),c=n(5657),d=n(4420),u=n(7154);let x="https://gwapp-api.onrender.com",h="wss://gwapp-api.onrender.com";const m=()=>{const e=window.localStorage.getItem("token");e?u.A.defaults.headers.common.Authorization=e:delete u.A.defaults.headers.common.Authorization},p=async(e,t)=>{try{m();return await u.A.post("".concat(x,"/").concat(e),t)}catch(G){console.error("Error during POST request:",G);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}},g=async e=>{try{m();return u.A?await u.A.get("".concat(x,"/").concat(e)):null}catch(G){console.error("Error fetching data:",G.message);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}},j=async(e,t)=>{try{m();return await u.A.put("".concat(x,"/").concat(e),t)}catch(G){console.error("Error during PUT request:",G);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}},A=async(e,t)=>{try{m();return await u.A.patch("".concat(x,"/").concat(e),t)}catch(G){console.error("Error during PATCH request:",G);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}},v=async e=>{try{m();return await u.A.delete("".concat(x,"/").concat(e))}catch(G){console.error("Error during DELETE request:",G);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}},y="users",f=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=arguments.length>2?arguments[2]:void 0;try{return await g("".concat(y,"?page=").concat(e,"&rowsPerPage=").concat(t,"&keyword=").concat(n))}catch(G){throw new Error(G.message)}},b=async e=>{try{return await g("".concat(y,"/").concat(e))}catch(G){throw console.log("Error fetching user:",G,G.message),new Error(G.message)}},w=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=arguments.length>2?arguments[2]:void 0;try{return await g("".concat(y,"/alumni?page=").concat(e,"&rowsPerPage=").concat(t,"&keyword=").concat(n))}catch(G){throw new Error(G.message)}},C=async e=>{try{return await A("deactivate-user",{userId:e})}catch(G){throw new Error(G.message)}},S=async()=>{try{return await g("budget-holders")}catch(G){throw new Error(G.message)}};var k=n(579);const N="INITIALIZE",L="SIGN_IN",F="SIGN_OUT",R="SET_USER",I={isAuthenticated:!1,isLoading:!0,user:null},E={[N]:(e,t)=>{const n=t.payload;return{...e,...n?{isAuthenticated:!0,isLoading:!1,user:n}:{isLoading:!1}}},[L]:(e,t)=>({...e,isAuthenticated:!0,user:t.payload}),[F]:e=>({...e,isAuthenticated:!1,user:null}),[R]:(e,t)=>({...e,isAuthenticated:!0,user:t.payload})},P=(e,t)=>E[t.type]?E[t.type](e,t):e,q=(0,s.createContext)({undefined:void 0}),M=e=>{const{children:t}=e,[n,i]=(0,s.useReducer)(P,I),a=(0,s.useRef)(!1),r=()=>{console.log("Checking token");const e=window.localStorage.getItem("token");if(e){const t=1e3*(0,d.s)(e).exp,n=Date.now()>t;return n&&(window.localStorage.clear(),window.location.href="/user/login"),n}};(0,s.useEffect)((()=>{r()}),[]);(0,s.useEffect)((()=>{(async()=>{if(a.current)return;a.current=!0;let e=!1;try{e="true"===window.localStorage.getItem("authenticated")}catch(t){console.error(t)}if(e){const e=window.localStorage.getItem("gwapp_userId");if(e){const t=await b(e),n=null===t||void 0===t?void 0:t.data;i({type:N,payload:n})}}else i({type:N}),r()&&(window.localStorage.removeItem("token"),window.localStorage.removeItem("authenticated"),window.localStorage.removeItem("gwapp_userId"),window.localStorage.clear(),window.location.href="/user/login")})()}),[]);return(0,k.jsx)(q.Provider,{value:{...n,setUser:e=>{i({type:R,payload:e})},signIn:async e=>{try{const t=await(async e=>{try{return await p("verify-login",{password:e})}catch(G){throw new Error(G.message)}})(e),{userData:n}=t.data,{status:s,token:a}=n;if("inactive"===s)throw new Error("User account is suspended.");return window.localStorage.setItem("gwapp_userId",n._id),window.localStorage.setItem("authenticated","true"),window.localStorage.setItem("token",a),i({type:L,payload:n}),t}catch(G){throw new Error(G.message)}},signOut:()=>{window.localStorage.removeItem("token"),window.localStorage.removeItem("authenticated"),window.localStorage.removeItem("gwapp_userId"),window.localStorage.removeItem("tokenExpiration"),window.localStorage.clear(),window.location.href="/user/login",i({type:F})}},children:t})},z=q.Consumer;var B=n(7304),H=n(3147),D=n(5857);const _=e=>({...e,alpha4:(0,D.X4)(e.main,.04),alpha8:(0,D.X4)(e.main,.08),alpha12:(0,D.X4)(e.main,.12),alpha30:(0,D.X4)(e.main,.3),alpha50:(0,D.X4)(e.main,.5)}),T={50:"#F8F9FA",100:"#F3F4F6",200:"#E5E7EB",300:"#D2D6DB",400:"#9DA4AE",500:"#6C737F",600:"#4D5761",700:"#2F3746",800:"#1C2536",900:"#111927",1e3:"#1a1a1a"},W=_({lightest:"#F5F7FF",light:"#EBEEFE",main:"#6366F1",dark:"#4338CA",darkest:"#312E81",contrastText:"#FFFFFF"}),U=_({lightest:"#F0FDF9",light:"#3FC79A",main:"#10B981",dark:"#0B815A",ppdc:"#006C37",darkest:"#134E48",contrastText:"#FFFFFF"}),O=_({lightest:"#ECFDFF",light:"#CFF9FE",main:"#06AED4",dark:"#0E7090",darkest:"#164C63",contrastText:"#FFFFFF"}),V=_({lightest:"#FFFAEB",light:"#FEF0C7",main:"#F79009",dark:"#B54708",darkest:"#7A2E0E",contrastText:"#FFFFFF"}),G=_({lightest:"#FEF3F2",light:"#FEE4E2",main:"#F04438",dark:"#B42318",darkest:"#7A271A",contrastText:"#FFFFFF"}),Y=_({lightest:"#E3F2FD",light:"#90CAF9",main:"#2196F3",dark:"#1976D2",darkest:"#0D47A1",contrastText:"#FFFFFF"});var Z=n(6222),X=n(6950),J=n(2766),$=n(9768),K=n(7502);const Q=(0,B.A)();function ee(){const e={action:{active:T[500],disabled:(0,D.X4)(T[900],.38),disabledBackground:(0,D.X4)(T[900],.12),focus:(0,D.X4)(T[900],.16),hover:(0,D.X4)(T[900],.04),selected:(0,D.X4)(T[900],.12)},background:{default:H.A.white,paper:H.A.white},divider:"#F2F4F7",error:G,info:O,blue:Y,mode:"light",neutral:T,primary:W,success:U,text:{primary:T[900],secondary:T[500],disabled:(0,D.X4)(T[900],.38)},warning:V},t=function(e){const{palette:t}=e;return{MuiAvatar:{styleOverrides:{root:{fontSize:14,fontWeight:600,letterSpacing:0}}},MuiButton:{styleOverrides:{root:{borderRadius:"12px",textTransform:"none",boxShadow:"none"},sizeSmall:{padding:"6px 16px"},sizeMedium:{padding:"8px 20px"},sizeLarge:{padding:"11px 24px"},textSizeSmall:{padding:"7px 12px"},textSizeMedium:{padding:"9px 16px"},textSizeLarge:{padding:"12px 16px"}}},MuiCard:{styleOverrides:{root:{borderRadius:20,["&.".concat(Z.A.elevation1)]:{boxShadow:"0px 5px 22px rgba(0, 0, 0, 0.04), 0px 0px 0px 0.5px rgba(0, 0, 0, 0.03)"}}}},MuiCardContent:{styleOverrides:{root:{padding:"32px 24px","&:last-child":{paddingBottom:"32px"}}}},MuiCardHeader:{defaultProps:{titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"body2"}},styleOverrides:{root:{padding:"32px 24px 16px"}}},MuiCssBaseline:{styleOverrides:{"*":{boxSizing:"border-box"},html:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",display:"flex",flexDirection:"column",minHeight:"100%",width:"100%"},body:{display:"flex",flex:"1 1 auto",flexDirection:"column",minHeight:"100%",width:"100%"},"#__next":{display:"flex",flex:"1 1 auto",flexDirection:"column",height:"100%",width:"100%"},"#nprogress":{pointerEvents:"none"},"#nprogress .bar":{backgroundColor:t.success.dark,height:3,left:0,position:"fixed",top:0,width:"100%",zIndex:2e3}}},MuiInputBase:{styleOverrides:{input:{"&::placeholder":{opacity:1}}}},MuiInput:{styleOverrides:{input:{fontSize:14,fontWeight:500,lineHeight:"24px","&::placeholder":{color:t.text.secondary}}}},MuiFilledInput:{styleOverrides:{root:{backgroundColor:"transparent",borderRadius:8,borderStyle:"solid",borderWidth:1,overflow:"hidden",borderColor:t.neutral[200],transition:Q.transitions.create(["border-color","box-shadow"]),"&:hover":{backgroundColor:t.action.hover},"&:before":{display:"none"},"&:after":{display:"none"},["&.".concat(X.A.disabled)]:{backgroundColor:"transparent"},["&.".concat(X.A.focused)]:{backgroundColor:"transparent",borderColor:t.success.dark,boxShadow:"".concat(t.success.dark," 0 0 0 2px")},["&.".concat(X.A.error)]:{borderColor:t.error.main,boxShadow:"".concat(t.error.main," 0 0 0 2px")}},input:{fontSize:14,fontWeight:500,lineHeight:"24px"}}},MuiOutlinedInput:{styleOverrides:{root:{"&:hover":{backgroundColor:t.action.hover,["& .".concat(J.A.notchedOutline)]:{borderColor:t.neutral[200]}},["&.".concat(J.A.focused)]:{backgroundColor:"transparent",["& .".concat(J.A.notchedOutline)]:{borderColor:t.success.dark,boxShadow:"".concat(t.success.dark," 0 0 0 2px"),borderTop:"1px solid transparent"}},["&.".concat(X.A.error)]:{["& .".concat(J.A.notchedOutline)]:{borderColor:t.error.main,boxShadow:"".concat(t.error.main," 0 0 0 2px")}}},input:{fontSize:14,fontWeight:500,lineHeight:"24px"},notchedOutline:{borderColor:t.neutral[200],transition:Q.transitions.create(["border-color","box-shadow"])}}},MuiFormLabel:{styleOverrides:{root:{fontSize:14,fontWeight:500,color:"neutral.1000",["&.".concat($.A.filled)]:{transform:"translate(12px, 18px) scale(1)"},["&.".concat($.A.focused)]:{color:"#1a1a1a"},["&.".concat($.A.shrink)]:{["&.".concat($.A.standard)]:{transform:"translate(0, 0px) scale(0.85)"},["&.".concat($.A.filled)]:{transform:"translate(12px, 6px) scale(0.85)",paddingTop:"2px"},["&.".concat($.A.outlined)]:{transform:"translate(14px, -9px) scale(0.85)",paddingTop:"5px"}}}}},MuiTab:{styleOverrides:{root:{fontSize:14,fontWeight:500,lineHeight:1.71,minWidth:"auto",paddingLeft:0,paddingRight:0,textTransform:"none","& + &":{marginLeft:24}}}},MuiTableCell:{styleOverrides:{root:{borderBottomColor:t.divider,padding:"15px 16px"}}},MuiTableHead:{styleOverrides:{root:{borderBottom:"none",["& .".concat(K.A.root)]:{borderBottom:"none",backgroundColor:t.neutral[50],color:t.neutral[700],fontSize:12,fontWeight:600,lineHeight:1,letterSpacing:.5,textTransform:"uppercase"},["& .".concat(K.A.paddingCheckbox)]:{paddingTop:4,paddingBottom:4}}}},MuiTextField:{defaultProps:{variant:"filled"}}}}({palette:e}),n=["none","0px 1px 2px rgba(0, 0, 0, 0.08)","0px 1px 5px rgba(0, 0, 0, 0.08)","0px 1px 8px rgba(0, 0, 0, 0.08)","0px 1px 10px rgba(0, 0, 0, 0.08)","0px 1px 14px rgba(0, 0, 0, 0.08)","0px 1px 18px rgba(0, 0, 0, 0.08)","0px 2px 16px rgba(0, 0, 0, 0.08)","0px 3px 14px rgba(0, 0, 0, 0.08)","0px 3px 16px rgba(0, 0, 0, 0.08)","0px 4px 18px rgba(0, 0, 0, 0.08)","0px 4px 20px rgba(0, 0, 0, 0.08)","0px 5px 22px rgba(0, 0, 0, 0.08)","0px 5px 24px rgba(0, 0, 0, 0.08)","0px 5px 26px rgba(0, 0, 0, 0.08)","0px 6px 28px rgba(0, 0, 0, 0.08)","0px 6px 30px rgba(0, 0, 0, 0.08)","0px 6px 32px rgba(0, 0, 0, 0.08)","0px 7px 34px rgba(0, 0, 0, 0.08)","0px 7px 36px rgba(0, 0, 0, 0.08)","0px 8px 38px rgba(0, 0, 0, 0.08)","0px 8px 40px rgba(0, 0, 0, 0.08)","0px 8px 42px rgba(0, 0, 0, 0.08)","0px 9px 44px rgba(0, 0, 0, 0.08)","0px 9px 46px rgba(0, 0, 0, 0.08)"],s={fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"',body1:{fontSize:"1rem",fontWeight:400,lineHeight:1.5},body2:{fontSize:"0.875rem",fontWeight:400,lineHeight:1.57},button:{fontWeight:600},caption:{fontSize:"0.75rem",fontWeight:500,lineHeight:1.66},subtitle1:{fontSize:"1rem",fontWeight:500,lineHeight:1.57},subtitle2:{fontSize:"0.875rem",fontWeight:500,lineHeight:1.57},overline:{fontSize:"0.75rem",fontWeight:600,letterSpacing:"0.5px",lineHeight:2.5,textTransform:"uppercase"},h1:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"3.5rem",lineHeight:1.2},h2:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"3rem",lineHeight:1.2},h3:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"2.25rem",lineHeight:1.2},h4:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"2rem",lineHeight:1.2},h5:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"1.5rem",lineHeight:1.2},h6:{fontFamily:"'Plus Jakarta Sans', sans-serif",fontWeight:700,fontSize:"1.125rem",lineHeight:1.2}};return(0,B.A)({breakpoints:{values:{xs:0,sm:600,md:900,lg:1200,xl:1440}},components:t,palette:e,shadows:n,shape:{borderRadius:8},typography:s})}var te=n(5513);n(6733);var ne=n(1036),se=(n(2342),n(446)),ie=n.n(se);const ae=e=>ie()(e).isValid()?ie()(e).format("MMM D, YYYY"):"Invalid Date",re=()=>(new Date).toISOString().split(".")[0],oe=(new Date).toLocaleString("en-NG",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),le=e=>new Promise(((t,n)=>{const s=document.createElement("canvas"),i=new Image,a=s.getContext("2d");i.crossOrigin="anonymous",i.onload=function(){s.width=i.width,s.height=i.height,a.drawImage(i,0,0);const e=s.toDataURL("image/png");t(e)},i.onerror=function(t){console.error("Failed to load image:",t.message),n(new Error("Failed to load image from URL: ".concat(e,". Error: ").concat(t.message)))},i.src=e})),ce=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",de={NGN:"\u20a6",USD:"$"},ue=e=>e<1e6?"".concat(e.toLocaleString()):e>=1e6&&e<1e9?"".concat((e/1e6).toFixed(2),"M"):e>=1e9&&e<1e12?"".concat((e/1e9).toFixed(2),"B"):"".concat((e/1e12).toFixed(2),"T"),xe=(e,t)=>(0,ne.oR)(e,{position:"bottom-left",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",type:t||"default"}),he=()=>{const[e,t]=s.useState("undefined"===typeof navigator||"boolean"!==typeof navigator.onLine||navigator.onLine),n=()=>t(!0),i=()=>t(!1);return s.useEffect((()=>(window.addEventListener("online",n),window.addEventListener("offline",i),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)})),[]),e},me=()=>{const e=he(),t=s.useRef(!0);return s.useEffect((()=>{t.current?t.current=!1:e?xe("Back online!","success"):xe("Poor network detected","warning")}),[e]),null};var pe=n(5475),ge=n(835),je=n(2703),Ae=n(1315),ve=n(5865),ye=n(6240);const fe=()=>{const e=(0,ye.A)().palette.primary.main;return(0,k.jsxs)("svg",{fill:"none",height:"100%",viewBox:"0 0 24 24",width:"100%",xmlns:"http://www.w3.org/2000/svg",children:[(0,k.jsx)("path",{opacity:.16,d:"M7.242 11.083c.449-1.674 2.17-3.394 3.843-3.843l10.434-2.796c1.673-.448 2.666.545 2.218 2.218L20.94 17.096c-.449 1.674-2.17 3.394-3.843 3.843L6.664 23.735c-1.673.448-2.666-.545-2.218-2.218l2.796-10.434Z",fill:e}),(0,k.jsx)("path",{d:"M3.06 6.9c.448-1.674 2.168-3.394 3.842-3.843L17.336.261c1.673-.448 2.667.545 2.218 2.218l-2.796 10.434c-.449 1.674-2.169 3.394-3.843 3.843L2.481 19.552C.808 20-.185 19.007.263 17.334L3.06 6.9Z",fill:e})]})},be=e=>{const{children:t}=e;return(0,s.useEffect)((()=>{const e=(0,i.Ay)(h,{withCredentials:!0});return e.on("ping",(e=>{console.log("Received ping: ".concat(e))})),()=>{e.disconnect()}}),[]),(0,k.jsx)(je.A,{component:"main",sx:{display:"flex",flex:"1 1 auto",height:"100vh"},children:(0,k.jsxs)(Ae.A,{container:!0,sx:{flex:"1 1 auto",minHeight:"100%"},children:[(0,k.jsxs)(Ae.A,{xs:12,lg:6,sx:{backgroundColor:"background.paper",display:"flex",flexDirection:"column",position:"relative"},children:[(0,k.jsx)(je.A,{component:"header",sx:{left:0,p:3,position:"fixed",top:0,width:"100%"},children:(0,k.jsx)(je.A,{component:pe.N_,to:"/",sx:{display:"inline-flex",height:32,width:32},children:(0,k.jsx)(fe,{})})}),t]}),(0,k.jsx)(Ae.A,{xs:12,lg:6,sx:{alignItems:"flex-start",background:"radial-gradient(50% 50% at 50% 50%, #122647 0%, #090E23 100%)",backgroundSize:"cover",color:"white",display:"flex",justifyContent:"center"},children:(0,k.jsxs)(je.A,{sx:{p:3,justifyContent:"flex-start"},children:[(0,k.jsxs)(ve.A,{align:"center",color:"inherit",sx:{fontSize:"24px",lineHeight:"32px",mb:1,mt:3},variant:"h1",children:["Welcome to"," ",(0,k.jsx)(je.A,{component:"a",sx:{color:"#15B79E"},target:"_blank",children:"GWAPP"})]}),(0,k.jsx)(ve.A,{align:"center",sx:{mb:3},variant:"subtitle1",children:"A solution by PPDC, to track requisition requests, payment approvals and manage records seamlessly"}),(0,k.jsx)("img",{alt:"",src:"/assets/auth-illustration.svg",style:{width:"100%",height:"auto",objectFit:"contain"}})]})})]})})};var we=n(4535),Ce=n(35),Se=n(1906),ke=n(8348);const Ne=e=>{const{children:t}=e,{isAuthenticated:n}=(0,s.useContext)(q),[i,a]=(0,s.useState)(!1),[r,o]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(()=>{const e=window.localStorage.getItem("token");if(e)try{const t=1e3*(0,d.s)(e).exp;Date.now()>t&&(a(!0),o(!0))}catch(G){console.error("Failed to decode token:",G),a(!0),o(!0)}else a(!0),o(!0)})()}),[]);const l=()=>{o(!1),window.localStorage.removeItem("token"),window.localStorage.removeItem("authenticated"),window.localStorage.removeItem("gwapp_userId"),window.localStorage.removeItem("tokenExpiration"),window.localStorage.clear(),window.location.href="/user/login"};return n?(0,k.jsx)(k.Fragment,{children:t}):i?(0,k.jsx)("div",{children:(0,k.jsxs)(Ce.A,{open:r,maxWidth:"sm",children:[(0,k.jsx)(je.A,{sx:{bgcolor:"background.paper",boxShadow:24,p:2,ml:4,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,k.jsxs)("svg",{id:"loader",width:"285",height:"65",viewBox:"0 0 285 65",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,k.jsx)("path",{d:"M200.75 59V43.5312H203.812C207.317 43.5312 210.409 43.1391 213.028 42.2822L213.028 42.2823L213.041 42.278C215.605 41.4231 217.806 40.2242 219.543 38.6152L219.55 38.6085L219.557 38.6017C221.241 37.0174 222.488 35.1617 223.255 33.0452C224.005 31.0098 224.375 28.8747 224.375 26.6562C224.375 21.7957 222.802 17.7369 219.397 14.8732C216.021 11.9958 210.999 10.8125 204.875 10.8125H192.938H190.438V13.3125V59V61.5H192.938H198.25H200.75V59ZM200.75 33.9688V20.3438H204.375C208.29 20.3438 210.65 21.073 211.938 22.0706L211.945 22.0757L211.952 22.0809C213.118 22.971 213.875 24.399 213.875 26.875C213.875 28.8713 213.456 30.1971 212.855 31.0714C212.25 31.9304 211.283 32.657 209.74 33.1496L209.732 33.152C208.125 33.6706 205.978 33.9688 203.219 33.9688H200.75Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M162.25 59V43.5312H165.312C168.817 43.5312 171.909 43.1391 174.528 42.2822L174.528 42.2823L174.541 42.278C177.105 41.4231 179.306 40.2242 181.043 38.6152L181.05 38.6085L181.057 38.6017C182.741 37.0174 183.988 35.1617 184.755 33.0452C185.505 31.0098 185.875 28.8747 185.875 26.6562C185.875 21.7957 184.302 17.7369 180.897 14.8732C177.521 11.9958 172.499 10.8125 166.375 10.8125H154.438H151.938V13.3125V59V61.5H154.438H159.75H162.25V59ZM162.25 33.9688V20.3438H165.875C169.79 20.3438 172.15 21.073 173.438 22.0706L173.445 22.0757L173.452 22.0809C174.618 22.971 175.375 24.399 175.375 26.875C175.375 28.8713 174.956 30.1971 174.355 31.0714C173.75 31.9304 172.783 32.657 171.24 33.1496L171.232 33.152C169.625 33.6706 167.478 33.9688 164.719 33.9688H162.25Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M140.263 59.9042L140.882 61.5H142.594H148.094H151.742L150.425 58.0979L132.675 12.2229L132.057 10.625H130.344H127.802L127.471 9.63304L127.229 10.625H125.562H123.854L123.233 12.2174L105.358 58.0924L104.03 61.5H107.688H113.062H114.778L115.395 59.8998L120.371 47H135.257L140.263 59.9042ZM124.053 37.2812L127.951 26.9549L131.781 37.2812H124.053Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M109.134 13.9584L109.975 10.8125H106.719H101.156H99.2167L98.7347 12.6912L91.5011 40.8867L83.0197 12.5946L82.4855 10.8125H80.625H75.1562H73.2782L72.7552 12.6163L64.6218 40.6655L57.453 12.6919L56.9714 10.8125H55.0312H49.5H46.25L47.0836 13.9538L59.2086 59.6413L59.7019 61.5H61.625H66.9688H68.8524L69.3718 59.6894L77.9453 29.8037L86.7582 59.7067L87.2867 61.5H89.1562H94.5H96.4193L96.9151 59.6459L109.134 13.9584Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M25.2812 32.5625H27.7812H43.75H46.25V35.0625V57.2188V59.0108L44.5529 59.5863C42.0193 60.4455 39.4113 61.0835 36.7307 61.5011M25.2812 32.5625L36.3438 59.0312M25.2812 32.5625V35.0625V39.8125V42.3125H27.7812H35.9375M25.2812 32.5625L35.9375 42.3125M36.7307 61.5011C36.7299 61.5012 36.7292 61.5014 36.7285 61.5015L36.3438 59.0312M36.7307 61.5011C36.731 61.5011 36.7313 61.501 36.7316 61.501L36.3438 59.0312M36.7307 61.5011C34.0571 61.9209 31.1018 62.125 27.875 62.125C22.7961 62.125 18.3278 61.1107 14.5901 58.9442L14.5841 58.9407C10.889 56.7853 8.08195 53.7065 6.18558 49.7732L6.18306 49.768C4.30013 45.8394 3.40625 41.2766 3.40625 36.1562C3.40625 31.0974 4.39959 26.5582 6.47549 22.6163L6.48087 22.6061L6.4809 22.6061C8.58545 18.6542 11.6321 15.5743 15.5737 13.4047M36.3438 59.0312C33.8229 59.4271 31 59.625 27.875 59.625C23.125 59.625 19.1146 58.6771 15.8438 56.7812C12.5938 54.8854 10.125 52.1875 8.4375 48.6875C6.75 45.1667 5.90625 40.9896 5.90625 36.1562C5.90625 31.4271 6.83333 27.3021 8.6875 23.7812C10.5625 20.2604 13.2604 17.5312 16.7812 15.5938L15.5715 13.4059C15.5723 13.4055 15.573 13.4051 15.5737 13.4047M15.5737 13.4047C19.5599 11.2012 24.2451 10.1562 29.5312 10.1562C32.2254 10.1562 34.8014 10.4098 37.2532 10.9261C39.6988 11.4161 41.9919 12.1221 44.1245 13.0522L46.4218 14.0543L45.414 16.349L43.3827 20.974L42.3834 23.2494L40.1021 22.2637C38.5516 21.5937 36.8141 21.009 34.882 20.5162L34.8761 20.5146C33.0667 20.0483 31.183 19.8125 29.2188 19.8125C25.8384 19.8125 23.0929 20.5088 20.88 21.7872C18.6684 23.0767 16.972 24.8855 15.7673 27.2743C14.5796 29.6705 13.9375 32.6048 13.9375 36.1562C13.9375 39.703 14.5093 42.6727 15.5734 45.127C16.597 47.4674 18.1648 49.2521 20.3175 50.5438C22.4196 51.805 25.289 52.5312 29.0938 52.5312C31.0639 52.5312 32.6944 52.4217 34.0069 52.2195C34.6854 52.1046 35.3288 51.9814 35.9375 51.8502V42.3125M15.5737 13.4047L35.9375 42.3125",stroke:"#006C37",strokeWidth:"3"})]})}),(0,k.jsxs)(je.A,{sx:{width:400,bgcolor:"background.paper",boxShadow:24,p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,k.jsx)(ke.A,{sx:{fontSize:40,color:"primary.main"}}),(0,k.jsx)(ve.A,{variant:"h6",align:"center",children:"Session Expired"}),(0,k.jsx)(je.A,{sx:{display:"flex",alignItems:"center",mt:1},children:(0,k.jsxs)(ve.A,{variant:"body1",align:"center",sx:{display:"flex",alignItems:"center"},children:["Login again to continue",(0,k.jsx)(ke.A,{sx:{ml:1}})]})}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,k.jsx)(Se.A,{variant:"contained",color:"primary",size:"large",onClick:l,children:"Yes"})})]})]})}):void 0};var Le,Fe=n(6293),Re=n(9336),Ie=n(2040),Ee=n(4109),Pe=n(7528),qe=n(8269);const Me=(0,we.Ay)(qe.A)(Le||(Le=(0,Pe.A)([""])));var ze=n(568),Be=n(9718),He=n(5623),De=n(3744),_e=n(8122),Te=n(9558),We=n(5627),Ue=n(2921),Oe=n(9248);const Ve=[{title:"Overview",path:"/",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(ze.A,{})})},{title:"Requisitions",path:"/requisitions",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(De.A,{})})},{title:"Retirements",path:"/retirements",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Te.A,{})})},{title:"Members",path:"/members",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(He.A,{})})},{title:"Projects & Codes",path:"/projects",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(We.A,{})})},{title:"Accounts",path:"/accounts",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Ue.A,{})})},{title:"Profile",path:"/profile",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Be.A,{})})},{title:"Bin",path:"/bin",icon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Oe.A,{})})}],Ge=()=>(0,s.useContext)(q),Ye=e=>{const{active:t,disabled:n,external:s,icon:i,path:a,title:r}=e,o=(0,ge.Zp)();return(0,k.jsx)("li",{children:(0,k.jsxs)(je.A,{sx:{alignItems:"center",borderRadius:1,display:"flex",justifyContent:"flex-start",pl:"16px",pr:"16px",py:"6px",textAlign:"left",width:"100%",cursor:"pointer",...t&&{backgroundColor:"rgba(255, 255, 255, 0.15)"},"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.04)"}},onClick:()=>{a&&!n&&(s?window.open(a,"_blank"):o(a))},disabled:n,children:[i&&(0,k.jsx)(je.A,{component:"span",sx:{alignItems:"center",color:"neutral.400",display:"inline-flex",justifyContent:"center",mr:2,...t&&{color:"success.main"}},children:i}),(0,k.jsx)(je.A,{component:"span",sx:{color:"neutral.400",flexGrow:1,fontFamily:e=>e.typography.fontFamily,fontSize:14,fontWeight:600,lineHeight:"24px",whiteSpace:"nowrap",...t&&{color:"common.white"},...n&&{color:"neutral.500"}},children:r})]})})},Ze=e=>{const{open:t,onClose:n}=e,i=(0,ge.zy)(),a=(0,Fe.A)((e=>e.breakpoints.up("lg"))),{user:r}=Ge(),[o,l]=(0,s.useState)([]);(0,s.useEffect)((()=>{const e=Ve.filter((e=>{switch(null===r||void 0===r?void 0:r.accessLevel){case"tech":case"finance":case"financeReviewer":return!0;case"superUser":return"/retirements"!==e.path;case"budgetHolder":return"/retirements"!==e.path&&"/accounts"!==e.path;case"user":return"/accounts"!==e.path&&"/projects"!==e.path&&"/bin"!==e.path;default:return!1}}));l(e)}),[r]);const c=(0,k.jsx)(Me,{children:(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",background:"neutral.100"},children:[(0,k.jsxs)(je.A,{sx:{p:3},children:[(0,k.jsx)("div",{style:{display:"inline-flex",height:32,width:32},children:(0,k.jsx)(pe.N_,{to:"/",children:(0,k.jsx)(fe,{})})}),(0,k.jsx)(je.A,{sx:{alignItems:"center",border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:1,cursor:"pointer",display:"flex",justifyContent:"space-between",mt:2,p:"12px"},children:(0,k.jsx)("div",{children:(0,k.jsx)(ve.A,{color:"inherit",variant:"Logo",children:"GWAPP"})})})]}),(0,k.jsx)(Re.A,{sx:{borderColor:"neutral.700"}}),(0,k.jsx)(je.A,{component:"nav",sx:{flexGrow:1,px:2,py:3},children:(0,k.jsx)(Ie.A,{component:"ul",spacing:.5,sx:{listStyle:"none",p:0,m:0},children:o.map((e=>(0,k.jsx)(Ye,{active:i.pathname===e.path,disabled:e.disabled,external:e.external,icon:e.icon,path:e.path,title:e.title},e.title)))})}),(0,k.jsx)(Re.A,{sx:{borderColor:"neutral.700"}})]})});return a?(0,k.jsx)(Ee.Ay,{anchor:"left",open:!0,PaperProps:{sx:{backgroundColor:"neutral.800",color:"common.white",width:280}},variant:"permanent",children:c}):(0,k.jsx)(Ee.Ay,{anchor:"left",onClose:n,open:t,PaperProps:{sx:{backgroundColor:"neutral.800",color:"common.white",width:280}},sx:{zIndex:e=>e.zIndex.appBar+100},variant:"temporary",children:c})};var Xe=n(4840),Je=n(1568),$e=n(7392),Ke=n(7739),Qe=n(1136),et=n(1045);function tt(){const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(!1),i=(0,s.useCallback)((()=>{n(!0)}),[]);return{anchorRef:e,handleClose:(0,s.useCallback)((()=>{n(!1)}),[]),handleOpen:i,handleToggle:(0,s.useCallback)((()=>{n((e=>!e))}),[]),open:t}}const nt=()=>{const e=(new Date).getHours();return e>=5&&e<12?"Good morning":e>=12&&e<18?"Good afternoon":"Good evening"},st=e=>{if(e){return e.split(" ")[0]}};var it=n(1020),at=n(2247),rt=n(8734);const ot="messages",lt=async e=>{try{return await g("".concat(ot,"/").concat(e))}catch(G){throw new Error(G.message)}},ct=async e=>{try{return await g("".concat(ot,"/user/").concat(e))}catch(G){throw new Error(G.message)}},dt=async(e,t,n)=>{try{const s={requisition_id:e,user_id:t,message:n};return await p(ot,s)}catch(G){throw new Error(G.message)}},ut=e=>{const{anchorEl:t,open:n,onClose:i}=e,{user:a}=Ge(),[r,o]=(0,s.useState)([]),l=(0,ge.Zp)();(0,s.useEffect)((()=>{(async()=>{const e=(await ct(null===a||void 0===a?void 0:a._id)).data.flatMap((e=>e.messages.map((t=>({...t,notificationId:e._id,requisitionId:e.requisition_id,createdAt:e.createdAt}))))).filter((e=>e.user_id===(null===a||void 0===a?void 0:a._id)));o(e)})()}),[null===a||void 0===a?void 0:a._id]);const c=e=>{const t=new Date,n=new Date(e),s=Math.abs(t.getTime()-n.getTime()),i=6e4,a=36e5,r=864e5;if(s<i)return"Less than a minute ago";if(s<a){const e=Math.floor(s/i);return"".concat(e," minute").concat(e>1?"s":""," ago")}if(s<r){const e=Math.floor(s/a);return"".concat(e," hour").concat(e>1?"s":""," ago")}{const e=Math.floor(s/r);return"".concat(e," day").concat(e>1?"s":""," ago")}},d=async(e,t)=>{await(async(e,t)=>{try{return await A("".concat(ot,"/mark-read/").concat(e,"/").concat(t))}catch(G){throw new Error(G.message)}})(null===a||void 0===a?void 0:a._id,e),l("/requisitions?id=".concat(t,"&action=openModal&selectedTab=allRequisitions"));const n=r.map((t=>t._id===e?{...t,read:!0}:t));o(n)};return(0,k.jsx)(it.Ay,{anchorEl:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:n,onClose:i,PaperProps:{sx:{maxHeight:400,overflowY:"auto"}},children:(0,k.jsxs)(je.A,{p:2,sx:{width:"18vw","@media (max-width: 600px)":{width:"60vw"}},children:[(0,k.jsx)(ve.A,{variant:"subtitle1",gutterBottom:!0,children:"Notifications"}),r.map((e=>(0,k.jsx)(Ke.A,{title:"Click to view item",placement:"top-start",children:(0,k.jsx)(at.Ay,{onClick:()=>d(e._id,e.requisitionId),style:{cursor:"pointer",backgroundColor:"".concat(e.read?"transparent":U.lightest),borderBottom:"0.1px solid #aaa"},children:(0,k.jsx)(rt.A,{sx:{margin:0,padding:0},primary:(0,k.jsx)(ve.A,{variant:"body2",children:e.message}),secondary:(0,k.jsx)(ve.A,{variant:"caption",children:c(e.createdAt)})})},e._id)},e._id))),0===r.length&&(0,k.jsx)(ve.A,{variant:"body2",color:"textSecondary",children:"No new notifications."})]})})};var xt=n(922),ht=n(2143);const mt=e=>{var t,n;const{anchorEl:i,onClose:a,open:r}=e,o=Ge(),l=(0,s.useCallback)((()=>{o.signOut()}),[o]);return(0,k.jsxs)(it.Ay,{anchorEl:i,anchorOrigin:{horizontal:"left",vertical:"bottom"},onClose:a,open:r,PaperProps:{sx:{width:200}},children:[(0,k.jsxs)(je.A,{sx:{py:1.5,px:2},children:[(0,k.jsx)(ve.A,{variant:"overline",children:"Account"}),(0,k.jsx)(ve.A,{color:"text.secondary",variant:"body2",children:null===(t=o.user)||void 0===t?void 0:t.name}),(0,k.jsx)(ve.A,{color:"text.secondary",variant:"body2",children:(0,k.jsx)("b",{children:null===(n=o.user)||void 0===n?void 0:n.email})})]}),(0,k.jsx)(Re.A,{}),(0,k.jsx)(xt.A,{disablePadding:!0,dense:!0,sx:{p:"8px","& > *":{borderRadius:1}},children:(0,k.jsx)(ht.A,{onClick:l,sx:{color:"error.main"},children:"Sign out"})})]})},pt=e=>{const{onNavOpen:t}=e,{user:n}=Ge(),i=(0,Fe.A)((e=>e.breakpoints.up("lg"))),a=tt(),r=tt(),[o,l]=(0,s.useState)(nt()),[c,d]=(0,s.useState)(0),u=(0,s.useCallback)((async()=>{if(null!==n&&void 0!==n&&n._id)try{const e=await ct(n._id),{data:t}=e,s=t.flatMap((e=>e.messages||[])).filter((e=>!e.read&&e.user_id===n._id)).length;d(s)}catch(G){console.error("Error fetching unread notifications:",G)}}),[null===n||void 0===n?void 0:n._id]);return(0,s.useEffect)((()=>{l(nt()),u()}),[u]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(je.A,{component:"header",sx:{backdropFilter:"blur(6px)",backgroundColor:e=>(0,D.X4)(e.palette.background.default,.8),position:"sticky",left:{lg:"".concat(280,"px")},top:0,width:{lg:"calc(100% - ".concat(280,"px)")},zIndex:e=>e.zIndex.appBar},children:[(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{minHeight:64,px:2},children:[(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:2,children:[!i&&(0,k.jsx)($e.A,{onClick:t,children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Je.A,{})})}),"".concat(o,", ").concat(st(null===n||void 0===n?void 0:n.name))]}),(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:2,children:[(0,k.jsx)(Ke.A,{title:"Notifications",children:(0,k.jsx)($e.A,{ref:r.anchorRef,onClick:r.handleOpen,children:(0,k.jsx)(Qe.A,{badgeContent:c,color:"success",children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Xe.A,{})})})})}),(0,k.jsx)(et.A,{onClick:a.handleOpen,ref:a.anchorRef,sx:{cursor:"pointer",height:40,width:40},src:(null===n||void 0===n?void 0:n.photoUrl)||""})]})]}),(0,k.jsx)(ut,{anchorEl:r.anchorRef.current,open:r.open,onClose:r.handleClose})]}),(0,k.jsx)(mt,{anchorEl:a.anchorRef.current,open:a.open,onClose:a.handleClose})]})};const gt=function(){const[e,t]=(0,s.useState)(!1),n=(0,ge.zy)();return(0,s.useEffect)((()=>{(()=>{const e=window.localStorage.getItem("token");if(e){const n=1e3*(0,d.s)(e).exp;Date.now()>n&&t(!0)}})()}),[n]),(0,k.jsxs)(Ce.A,{open:e,maxWidth:"sm",children:[(0,k.jsx)(je.A,{sx:{bgcolor:"background.paper",boxShadow:24,p:2,ml:4,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,k.jsxs)("svg",{id:"loader",width:"285",height:"65",viewBox:"0 0 285 65",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,k.jsx)("path",{d:"M200.75 59V43.5312H203.812C207.317 43.5312 210.409 43.1391 213.028 42.2822L213.028 42.2823L213.041 42.278C215.605 41.4231 217.806 40.2242 219.543 38.6152L219.55 38.6085L219.557 38.6017C221.241 37.0174 222.488 35.1617 223.255 33.0452C224.005 31.0098 224.375 28.8747 224.375 26.6562C224.375 21.7957 222.802 17.7369 219.397 14.8732C216.021 11.9958 210.999 10.8125 204.875 10.8125H192.938H190.438V13.3125V59V61.5H192.938H198.25H200.75V59ZM200.75 33.9688V20.3438H204.375C208.29 20.3438 210.65 21.073 211.938 22.0706L211.945 22.0757L211.952 22.0809C213.118 22.971 213.875 24.399 213.875 26.875C213.875 28.8713 213.456 30.1971 212.855 31.0714C212.25 31.9304 211.283 32.657 209.74 33.1496L209.732 33.152C208.125 33.6706 205.978 33.9688 203.219 33.9688H200.75Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M162.25 59V43.5312H165.312C168.817 43.5312 171.909 43.1391 174.528 42.2822L174.528 42.2823L174.541 42.278C177.105 41.4231 179.306 40.2242 181.043 38.6152L181.05 38.6085L181.057 38.6017C182.741 37.0174 183.988 35.1617 184.755 33.0452C185.505 31.0098 185.875 28.8747 185.875 26.6562C185.875 21.7957 184.302 17.7369 180.897 14.8732C177.521 11.9958 172.499 10.8125 166.375 10.8125H154.438H151.938V13.3125V59V61.5H154.438H159.75H162.25V59ZM162.25 33.9688V20.3438H165.875C169.79 20.3438 172.15 21.073 173.438 22.0706L173.445 22.0757L173.452 22.0809C174.618 22.971 175.375 24.399 175.375 26.875C175.375 28.8713 174.956 30.1971 174.355 31.0714C173.75 31.9304 172.783 32.657 171.24 33.1496L171.232 33.152C169.625 33.6706 167.478 33.9688 164.719 33.9688H162.25Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M140.263 59.9042L140.882 61.5H142.594H148.094H151.742L150.425 58.0979L132.675 12.2229L132.057 10.625H130.344H127.802L127.471 9.63304L127.229 10.625H125.562H123.854L123.233 12.2174L105.358 58.0924L104.03 61.5H107.688H113.062H114.778L115.395 59.8998L120.371 47H135.257L140.263 59.9042ZM124.053 37.2812L127.951 26.9549L131.781 37.2812H124.053Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M109.134 13.9584L109.975 10.8125H106.719H101.156H99.2167L98.7347 12.6912L91.5011 40.8867L83.0197 12.5946L82.4855 10.8125H80.625H75.1562H73.2782L72.7552 12.6163L64.6218 40.6655L57.453 12.6919L56.9714 10.8125H55.0312H49.5H46.25L47.0836 13.9538L59.2086 59.6413L59.7019 61.5H61.625H66.9688H68.8524L69.3718 59.6894L77.9453 29.8037L86.7582 59.7067L87.2867 61.5H89.1562H94.5H96.4193L96.9151 59.6459L109.134 13.9584Z",stroke:"#006C37",strokeWidth:"3"}),(0,k.jsx)("path",{d:"M25.2812 32.5625H27.7812H43.75H46.25V35.0625V57.2188V59.0108L44.5529 59.5863C42.0193 60.4455 39.4113 61.0835 36.7307 61.5011M25.2812 32.5625L36.3438 59.0312M25.2812 32.5625V35.0625V39.8125V42.3125H27.7812H35.9375M25.2812 32.5625L35.9375 42.3125M36.7307 61.5011C36.7299 61.5012 36.7292 61.5014 36.7285 61.5015L36.3438 59.0312M36.7307 61.5011C36.731 61.5011 36.7313 61.501 36.7316 61.501L36.3438 59.0312M36.7307 61.5011C34.0571 61.9209 31.1018 62.125 27.875 62.125C22.7961 62.125 18.3278 61.1107 14.5901 58.9442L14.5841 58.9407C10.889 56.7853 8.08195 53.7065 6.18558 49.7732L6.18306 49.768C4.30013 45.8394 3.40625 41.2766 3.40625 36.1562C3.40625 31.0974 4.39959 26.5582 6.47549 22.6163L6.48087 22.6061L6.4809 22.6061C8.58545 18.6542 11.6321 15.5743 15.5737 13.4047M36.3438 59.0312C33.8229 59.4271 31 59.625 27.875 59.625C23.125 59.625 19.1146 58.6771 15.8438 56.7812C12.5938 54.8854 10.125 52.1875 8.4375 48.6875C6.75 45.1667 5.90625 40.9896 5.90625 36.1562C5.90625 31.4271 6.83333 27.3021 8.6875 23.7812C10.5625 20.2604 13.2604 17.5312 16.7812 15.5938L15.5715 13.4059C15.5723 13.4055 15.573 13.4051 15.5737 13.4047M15.5737 13.4047C19.5599 11.2012 24.2451 10.1562 29.5312 10.1562C32.2254 10.1562 34.8014 10.4098 37.2532 10.9261C39.6988 11.4161 41.9919 12.1221 44.1245 13.0522L46.4218 14.0543L45.414 16.349L43.3827 20.974L42.3834 23.2494L40.1021 22.2637C38.5516 21.5937 36.8141 21.009 34.882 20.5162L34.8761 20.5146C33.0667 20.0483 31.183 19.8125 29.2188 19.8125C25.8384 19.8125 23.0929 20.5088 20.88 21.7872C18.6684 23.0767 16.972 24.8855 15.7673 27.2743C14.5796 29.6705 13.9375 32.6048 13.9375 36.1562C13.9375 39.703 14.5093 42.6727 15.5734 45.127C16.597 47.4674 18.1648 49.2521 20.3175 50.5438C22.4196 51.805 25.289 52.5312 29.0938 52.5312C31.0639 52.5312 32.6944 52.4217 34.0069 52.2195C34.6854 52.1046 35.3288 51.9814 35.9375 51.8502V42.3125M15.5737 13.4047L35.9375 42.3125",stroke:"#006C37",strokeWidth:"3"})]})}),(0,k.jsxs)(je.A,{sx:{width:400,bgcolor:"background.paper",boxShadow:24,p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,k.jsx)(ke.A,{sx:{fontSize:40,color:"primary.main"}}),(0,k.jsx)(ve.A,{variant:"h6",align:"center",children:"Session Expired"}),(0,k.jsx)(je.A,{sx:{display:"flex",alignItems:"center",mt:1},children:(0,k.jsxs)(ve.A,{variant:"body1",align:"center",sx:{display:"flex",alignItems:"center"},children:["Login again to continue",(0,k.jsx)(ke.A,{sx:{ml:1}})]})}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,k.jsx)(Se.A,{variant:"contained",color:"primary",size:"large",onClick:()=>{t(!1),window.localStorage.removeItem("token"),window.localStorage.removeItem("authenticated"),window.localStorage.removeItem("gwapp_userId"),window.localStorage.removeItem("tokenExpiration"),window.localStorage.clear(),window.location.href="/user/login"},children:"Yes"})})]})]})},jt=(0,we.Ay)("div")((e=>{let{theme:t}=e;return{display:"flex",flex:"1 1 auto",maxWidth:"100%",[t.breakpoints.up("lg")]:{paddingLeft:280}}})),At=(0,we.Ay)("div")({display:"flex",flex:"1 1 auto",flexDirection:"column",width:"100%"}),vt=(e=>{const t=t=>(0,k.jsx)(Ne,{children:(0,k.jsx)(e,{...t})});return t.displayName="withAuthGuard(".concat(e.displayName||e.name,")"),t})((e=>{const{children:t}=e,n=(0,ge.zy)(),[a,r]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=(0,i.Ay)(h,{withCredentials:!0});return e.on("ping",(e=>{console.log("Received ping: ".concat(e))})),()=>{e.disconnect()}}),[]);const o=(0,s.useCallback)((()=>{a&&r(!1)}),[a]);return(0,s.useEffect)((()=>{o()}),[n.pathname]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(pt,{onNavOpen:()=>r(!0)}),(0,k.jsx)(Ze,{onClose:()=>r(!1),open:a}),(0,k.jsx)(jt,{children:(0,k.jsx)(At,{children:t})}),(0,k.jsx)(gt,{})]})}));var yt=n(2455),ft=n(5381),bt=n(5360),wt=n.n(bt);function Ct(){const e=(0,ge.zy)();(0,s.useEffect)((()=>(wt().start(),()=>{wt().done()})),[e])}const St=()=>{Ct();const e=(0,ge.Zp)();return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{alignItems:"center",display:"flex",flexGrow:1,minHeight:"100%"},children:(0,k.jsx)(ft.A,{maxWidth:"md",children:(0,k.jsxs)(je.A,{sx:{alignItems:"center",display:"flex",flexDirection:"column"},children:[(0,k.jsx)(je.A,{sx:{mb:3,textAlign:"center"},children:(0,k.jsx)("img",{alt:"Under development",src:"/assets/errors/error-404.png",style:{display:"inline-block",maxWidth:"100%",width:400}})}),(0,k.jsx)(ve.A,{align:"center",sx:{mb:3},variant:"h3",children:"404: The page you are looking for isn\u2019t here"}),(0,k.jsx)(ve.A,{align:"center",color:"text.secondary",variant:"body1",children:"You either tried some shady route or you came here by mistake. Whichever it is, try using the navigation"}),(0,k.jsx)(Se.A,{onClick:()=>{e(-1)},startIcon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(yt.A,{})}),sx:{mt:3},variant:"contained",children:"Go back to dashboard"})]})})})})};var kt=n(6534),Nt=n(899),Lt=n(9869),Ft=n(4056),Rt=n(5795),It=n(1243),Et=n(8903),Pt=n(8619);const qt=[" "," "," "," "," "," "],Mt=(e,t)=>{let{length:n,onChange:i}=e;const a=(0,s.useRef)([]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ve.A,{variant:"subtitle2",sx:{mb:1},children:"6-Digit Code"}),(0,k.jsx)(Pt.A,{type:"text",className:"code-input",onChange:e=>{i(e)},autoFocus:!0,ref:t,placeholder:qt,onPaste:e=>{[...e].slice(0,n).forEach(((e,t)=>a.current[t].value=e)),i(e)},sx:{"& > input":{marginRight:10}}})]})},zt=(0,s.forwardRef)(Mt),Bt=e=>{let{openModal:t,setOpenModal:n,regToken:i}=e;const[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)(!1),c=(0,ge.Zp)(),d=Ge();(0,s.useEffect)((()=>{6===a.length&&u()}),[a]);const u=async()=>{l(!0);try{const e=await d.signIn(a);e&&200===e.status&&(l(!1),x())}catch(G){return l(!1),ne.oR.warning(G.message)}},x=()=>{n(!t),c("/")};return(0,k.jsx)(It.A,{disableEnforceFocus:!0,open:t,"aria-labelledby":"auth-code-input-modal","aria-describedby":"auth-code-input-modal-description",children:(0,k.jsxs)(je.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2},children:[(0,k.jsx)(ve.A,{sx:{mb:2},variant:"h6",gutterBottom:!0,children:"Enter the OTP sent to your email"}),(0,k.jsx)(zt,{length:6,onChange:r}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:6,children:(0,k.jsx)(Se.A,{sx:{mt:2},variant:"contained",color:"primary",onClick:()=>n(!1),children:"Cancel"})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,sx:{display:"flex",justifyContent:"flex-end"},children:(0,k.jsx)(Se.A,{sx:{mt:2},onClick:u,disabled:o,color:"info",variant:"contained",children:o?"Verifying...":"Verify"})})]})]})})},Ht=()=>{Ct();const[e,t]=(0,s.useState)(!1),[n,i]=(0,s.useState)(!1),[a,r]=(0,s.useState)("email"),o=(0,kt.Wx)({initialValues:{email:"",submit:null},validationSchema:Nt.Ik({email:Nt.Yj().email("Must be a valid email").max(255).required("Email is required")}),onSubmit:async(e,n)=>{i(!0);try{const s=await(async e=>{try{return await p("login",{email:e})}catch(G){throw new Error(G.message)}})(e.email);s&&200===s.status?(t(!0),i(!1)):(n.setStatus({success:!1}),n.setErrors({submit:"Sorry, something went wrong. Please try again."}),n.setSubmitting(!1))}catch(s){n.setStatus({success:!1}),n.setErrors({submit:s.message}),n.setSubmitting(!1)}finally{i(!1)}}}),l=(0,s.useCallback)(((e,t)=>{r(t)}),[]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(je.A,{sx:{backgroundColor:"background.paper",flex:"1 1 auto",alignItems:"center",display:"flex",justifyContent:"center"},children:[(0,k.jsx)(je.A,{sx:{maxWidth:550,px:3,py:"100px",width:"100%"},children:(0,k.jsxs)("div",{children:[(0,k.jsx)(Ie.A,{spacing:1,sx:{mb:3},children:(0,k.jsx)(ve.A,{variant:"h4",children:"Login"})}),(0,k.jsx)(Lt.A,{onChange:l,sx:{mb:3,"& .MuiTab-root.Mui-selected":{color:"success.dark"},"& .MuiTabs-indicator":{backgroundColor:"success.dark"}},value:a,children:(0,k.jsx)(Ft.A,{label:"Login to your account",value:"email"})}),"email"===a&&(0,k.jsxs)("form",{noValidate:!0,onSubmit:o.handleSubmit,children:[(0,k.jsx)(Ie.A,{spacing:3,children:(0,k.jsx)(Rt.A,{error:!(!o.touched.email||!o.errors.email),fullWidth:!0,helperText:o.touched.email&&o.errors.email,label:"Email Address",name:"email",onBlur:o.handleBlur,onChange:o.handleChange,type:"email",value:o.values.email})}),o.errors.submit&&(0,k.jsx)(ve.A,{color:"error",sx:{mt:3},variant:"body2",children:o.errors.submit}),(0,k.jsx)(Se.A,{fullWidth:!0,size:"large",sx:{mt:3,backgroundColor:"success.darkest","&:hover":{backgroundColor:"success.main",transform:"scale(1.01)",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.15)"}},type:"submit",variant:"contained",disabled:n,children:n?"Logging in...":"Continue"})]}),"phoneNumber"===a&&(0,k.jsx)("div",{children:(0,k.jsx)(ve.A,{color:"text.secondary",children:"Loading form..."})})]})}),(0,k.jsx)(Bt,{openModal:e,setOpenModal:t})]})})};var Dt=n(6600),_t=n(5316),Tt=n(6311),Wt=n(9347);const Ut=[{bankName:"Access Bank",bankCode:"044"},{bankName:"Citibank",bankCode:"023"},{bankName:"Diamond Bank",bankCode:"063"},{bankName:"Ecobank Nigeria",bankCode:"050"},{bankName:"Fidelity Bank Nigeria",bankCode:"070"},{bankName:"First Bank of Nigeria",bankCode:"011"},{bankName:"First City Monument Bank (FCMB)",bankCode:"214"},{bankName:"Guaranty Trust Bank (GTBank)",bankCode:"058"},{bankName:"Heritage Bank Plc",bankCode:"030"},{bankName:"Keystone Bank Limited",bankCode:"082"},{bankName:"Polaris Bank",bankCode:"076"},{bankName:"Providus Bank",bankCode:"101"},{bankName:"Stanbic IBTC Bank Nigeria Limited",bankCode:"221"},{bankName:"Standard Chartered Bank",bankCode:"068"},{bankName:"Sterling Bank",bankCode:"232"},{bankName:"Suntrust Bank Nigeria Limited",bankCode:"100"},{bankName:"Union Bank of Nigeria",bankCode:"032"},{bankName:"United Bank for Africa (UBA)",bankCode:"033"},{bankName:"Unity Bank Plc",bankCode:"215"},{bankName:"Wema Bank",bankCode:"035"},{bankName:"Zenith Bank",bankCode:"057"}],Ot="accounts",Vt=e=>{let{updateAccounts:t}=e;const[n,i]=(0,s.useState)(!1),[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),u=()=>{i(!1)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{color:"info",size:"small",variant:"outlined",onClick:()=>{i(!0)},children:"Add New Bank Account"}),(0,k.jsxs)(Ce.A,{open:n,onClose:u,children:[(0,k.jsx)(Dt.A,{children:"Add New Account"}),(0,k.jsxs)(_t.A,{children:[(0,k.jsx)(Tt.A,{options:Ut.map((e=>e.bankName)),renderInput:e=>(0,k.jsx)(Rt.A,{...e,name:"bankName",label:"Bank Name",value:a,onSelect:e=>r(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),onInputChange:e=>{r(e.target.value)}}),(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Account Name",value:o,onChange:e=>l(e.target.value)}),(0,k.jsx)(Rt.A,{sx:{mt:2},fullWidth:!0,label:"Account Number",value:c,onChange:e=>d(e.target.value)})]}),(0,k.jsxs)(Wt.A,{children:[(0,k.jsx)(Se.A,{color:"error",onClick:u,children:"Cancel"}),(0,k.jsx)(Se.A,{color:"success",onClick:async()=>{try{const n={bankName:a,accountName:o,accountNumber:c},s=await(e=n,p(Ot,e));201===s.status&&(ne.oR.success("Account added successfully"),201===s.status&&(r(""),l(""),d(""),i(!1),t()))}catch(G){ne.oR.error(G.message)}var e},children:"Add"})]})]})]})};var Gt=n(9650),Yt=n(1806),Zt=n(4882),Xt=n(8076),Jt=n(9652),$t=n(3460),Kt=n(7141),Qt=n(3768),en=n(3560);const tn=e=>{let{accounts:t,onDelete:n,onEdit:i,isVendor:a}=e;const[r,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(""),[d,u]=(0,s.useState)("");return(0,k.jsx)(k.Fragment,{children:t&&t.length>0?(0,k.jsx)(Gt.A,{sx:{mt:2},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:"Bank Name"}),(0,k.jsx)(Jt.A,{children:"Holder"}),(0,k.jsx)(Jt.A,{children:"Account Number"}),!a&&(0,k.jsx)(Jt.A,{children:"Action"})]})}),(0,k.jsx)($t.A,{children:t.map((e=>(0,k.jsxs)(Xt.A,{sx:r===e._id?{border:"1px solid #0B815A"}:{},children:[(0,k.jsx)(Jt.A,{children:e.bankName}),(0,k.jsx)(Jt.A,{children:r===e._id?(0,k.jsx)(Rt.A,{defaultValue:e.accountName,onChange:e=>c(e.target.value)}):e.accountName}),(0,k.jsx)(Jt.A,{children:r===e._id?(0,k.jsx)(Rt.A,{defaultValue:e.accountNumber,onChange:e=>u(e.target.value)}):e.accountNumber}),!a&&(0,k.jsx)(Jt.A,{children:r===e._id?(0,k.jsx)($e.A,{onClick:()=>(e=>{const n=t.find((t=>t._id===e));l&&(n.accountName=l),d&&(n.accountNumber=d),i(n),o(null)})(e._id),"aria-label":"save",children:(0,k.jsx)(_e.A,{color:"success",fontSize:"small",children:(0,k.jsx)(Kt.A,{})})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)($e.A,{onClick:()=>n(e._id),"aria-label":"delete",children:(0,k.jsx)(_e.A,{color:"error",fontSize:"small",children:(0,k.jsx)(Qt.A,{})})}),(0,k.jsx)($e.A,{onClick:()=>{return t=e._id,void o(t);var t},"aria-label":"edit",children:(0,k.jsx)(_e.A,{color:"info",fontSize:"small",children:(0,k.jsx)(en.A,{})})})]})})]},e._id)))})]})}):(0,k.jsx)(ve.A,{sx:{mt:2},children:"No Accounts found."})})},nn="vendors",sn=()=>{Ct();const[e,t]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[a,r]=(0,s.useState)(0),o=async()=>{try{const e=await g(Ot);t(e.data)}catch(G){ne.oR.error(G.message)}},l=async()=>{try{const e=await g(nn);i(e.data)}catch(G){ne.oR.error(G.message)}};(0,s.useEffect)((()=>{o(),l()}),[]);const c=async n=>{try{await(e=>v("".concat(Ot,"/").concat(e)))(n),t(e.filter((e=>e._id!==n))),ne.oR.success("Account deleted successfully")}catch(G){ne.oR.error(G.message)}},d=async n=>{try{await(s=n._id,i=n,A("".concat(Ot,"/").concat(s),i)),t(e.map((e=>e._id===n._id?n:e))),ne.oR.success("Account updated successfully")}catch(G){ne.oR.error(G.message)}var s,i};return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"lg",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsx)(je.A,{children:(0,k.jsx)(ve.A,{variant:"h6",children:"Bank Accounts"})}),(0,k.jsxs)(je.A,{children:[(0,k.jsxs)(Lt.A,{value:a,onChange:(e,t)=>{r(t)},indicatorColor:"primary",textColor:"primary",sx:{mb:2},children:[(0,k.jsx)(Ft.A,{label:"Bank Accounts"}),(0,k.jsx)(Ft.A,{label:"Staff Vendor Accounts"})]}),(0,k.jsx)(Re.A,{}),(0,k.jsxs)(je.A,{sx:{mt:2},children:[0===a&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Vt,{updateAccounts:async()=>{o()}}),(0,k.jsx)(tn,{accounts:e,onDelete:c,onEdit:d})]}),1===a&&(0,k.jsx)(tn,{accounts:n,onDelete:c,onEdit:d,isVendor:!0})]})]})]})})})})};var an=n(8555);const rn="requisitions",on=e=>g("".concat(rn,"/").concat(e)),ln=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e).length?"?".concat(new URLSearchParams(e).toString()):"";return(async e=>{try{return m(),u.A?await u.A.get("".concat(x,"/").concat(e),{responseType:"blob"}):null}catch(G){console.error("Error fetching blob data:",G.message);let t="An error occurred.";throw G.response&&G.response.data&&(t=G.response.data.message||G.response.data.error),new Error(t)}})("print/approved".concat(t))},cn=(e,t,n)=>g(t&&n?"user-requisitions/".concat(e,"?page=").concat(t,"&limit=").concat(n):"user-requisitions/".concat(e)),dn=(e,t,n)=>g(t&&n?"user-requisitions/unretired/".concat(e,"?page=").concat(t,"&limit=").concat(n):"user-requisitions/unretired/".concat(e)),un=(e,t)=>j("".concat(rn,"/").concat(e),t),xn=e=>j("requisitions/delete/".concat(e)),hn=e=>A("finance-requisitions/retire/".concat(e)),mn=e=>j("send-requisition-back/".concat(e)),pn=e=>{switch(e){case"NGN":return"\u20a6";case"USD":return"$";case"EUR":return"\u20ac";default:return""}},gn=e=>null!==e&&void 0!==e?e.toLocaleString("en-NG"):null,jn=e=>e?"Invalid Date"===new Date(e).toString()?"N/A":new Date(e).toLocaleDateString(void 0,{day:"numeric",month:"numeric",year:"numeric"}):"-",An=()=>{const[e,t]=(0,s.useState)([]),[n,i]=(0,s.useState)(0),[a,r]=(0,s.useState)(!1);(0,s.useEffect)((()=>{o()}),[]);const o=async()=>{r(!0);try{const e=await g("requisitions/bin");t(e.data)}catch(G){console.error("Error fetching bin requisitions:",G)}finally{r(!1)}},l=async e=>{try{await(e=>v("requisitions/destroy/".concat(e)))(e),t((t=>t.filter((t=>t._id!==e))))}catch(G){console.error("Error destroying requisition:",G)}},c=Math.ceil(e.length/10),d=10*n,u=d+10,x=e.slice(d,u);return(0,k.jsxs)(je.A,{children:[0===x.length&&(0,k.jsx)("p",{children:"Bin is Empty!"}),x.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gt.A,{component:an.A,children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"45%"},children:"Title"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Amount"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Raised By"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Date"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Action"})]})}),(0,k.jsx)($t.A,{children:x.map((e=>(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:e.title}),(0,k.jsxs)(Jt.A,{children:[pn(null===e||void 0===e?void 0:e.currency),ue(Number(null===e||void 0===e?void 0:e.total))]}),(0,k.jsx)(Jt.A,{children:e.user.name}),(0,k.jsx)(Jt.A,{children:jn(e.date)}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Se.A,{size:"small",variant:"contained",color:"error",onClick:()=>l(e._id),disabled:a,children:"Destroy"})})]},e._id)))})]})}),(0,k.jsxs)(je.A,{mt:2,display:"flex",justifyContent:"center",children:[(0,k.jsx)(Se.A,{onClick:()=>{i((e=>Math.max(e-1,0)))},disabled:0===n||a,children:"Previous"}),(0,k.jsx)(Se.A,{onClick:()=>{i((e=>Math.min(e+1,c-1)))},disabled:n===c-1||a,children:"Next"})]})]})]})},vn=()=>(Ct(),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"lg",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsx)(je.A,{children:(0,k.jsx)(ve.A,{color:"error",variant:"h6",children:"Requisitions set for deletion"})}),(0,k.jsx)(je.A,{children:(0,k.jsx)(An,{})})]})})})}));var yn=n(5173),fn=n.n(yn),bn=n(1408),wn=n(1637),Cn=n(2110),Sn=n(9958),kn=n(7600);const Nn=(0,we.Ay)("span")((e=>{let{theme:t,ownerState:n}=e;return{alignItems:"center",backgroundColor:t.palette[n.color].alpha12,borderRadius:12,color:"dark"===t.palette.mode?t.palette[n.color].main:t.palette[n.color].dark,cursor:"default",display:"inline-flex",flexGrow:0,flexShrink:0,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),lineHeight:2,fontWeight:600,justifyContent:"center",letterSpacing:.5,minWidth:20,paddingLeft:t.spacing(1),paddingRight:t.spacing(1),textTransform:"capitalize",whiteSpace:"nowrap"}})),Ln=e=>{const{color:t="primary",children:n,...s}=e,i={color:t};return(0,k.jsx)(Nn,{ownerState:i,...s,children:n})},Fn=(e,t)=>e&&""!==e.trim()?e.length<=t?e:e.substring(0,t-3)+"...":"",Rn={pending:"neutral",holderChecked:"blue",holderCheck:"blue",requested:"secondary",checked:"primary",reviewed:"info",approved:"success",retired:"success",sentBack:"warning",cancelled:"error",controlled:"error",deleted:"error"},In=("".concat(x,"/verify-password"),"".concat(x,"/change-password"),"".concat(x,"/reset-password"),"".concat(x,"/requisitions"),"".concat(x,"/requisitions/approved"),"".concat(x,"/requisitions/bin"),"".concat(x,"/filter-requisitions"),"".concat(x,"/projects"),"".concat(x,"/budget-codes")),En=("".concat(x,"/upload-file"),"".concat(x,"/messages"),"".concat(x,"/users"),"".concat(x,"/deactivate-user"),"".concat(x,"/change-user-access"),"".concat(x,"/accounts"),"".concat(x,"/account-codes")),Pn=("".concat(x,"/budget-codes"),"".concat(x,"/projects")),qn={user:"User",superUser:"Super User",userManager:"User Mgmt.",budgetHolder:"Budget Holder",finance:"Finance",financeReviewer:"Reviewer",tech:"Tech"},Mn={_id:"",accountName:"",accountNumber:"",amountInWords:"",approvedBy:{email:"",name:"",photoUrl:"",signatureUrl:""},approvedDate:"",attentionTo:[],bankName:"",budgetLineItems:[{label:"",value:"",_id:""}],checkedBy:{email:"",name:"",photoUrl:"",signatureUrl:""},checkedDate:"",codes:"",countRef:0,currency:"",date:"",hoderCheckDate:"",holderCheckDate:"",holderCheck:{email:"",name:"",signatureUrl:""},id:"",includeTax:!1,invoices:[{id:"",name:"",url:"",_id:""},{id:"",name:"",url:"",_id:""}],items:[{amount:0,code:"",title:"",_id:""}],name:"",projectChargedTo:{account:{accountName:"",accountNumber:"",balance:"",bankName:"",id:""},funder:"",id:"",projectName:""},projectId:"",projectName:"",pvNumber:0,reviewDate:"",reviewedBy:{email:"",name:"",photoUrl:"",signatureUrl:""},sourceAccountNumber:"",sourceBankName:"",status:"",step:0,taxPercentage:"",taxable:"",time:"",title:"",total:"",type:"",user:{email:"",name:"",photoUrl:"",signatureUrl:""},userId:"",paid:!1,retired:!1,updatedAt:""},zn=e=>{const{latestReqs:t=[],sx:n,loading:s}=e;return s?(0,k.jsxs)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,k.jsx)(wn.A,{color:"success"}),(0,k.jsx)(je.A,{sx:{mt:2},children:"Relax while we load your data..."})]}):(0,k.jsxs)(Cn.A,{sx:n,children:[(0,k.jsx)(Sn.A,{title:"Recent highlight"}),(0,k.jsx)(ft.A,{children:0===t.length&&(0,k.jsx)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,k.jsx)(je.A,{sx:{mt:2},children:"No requisitions found"})})}),t.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Me,{sx:{flexGrow:1},children:(0,k.jsx)(je.A,{sx:{minWidth:800},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"40%"},children:"Title"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Type"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Amount"}),(0,k.jsx)(Jt.A,{sortDirection:"desc",sx:{width:"15%"},children:"Date"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Status"})]})}),(0,k.jsx)($t.A,{children:t.map((e=>(0,k.jsxs)(Xt.A,{hover:!0,children:[(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Ke.A,{title:"".concat(e.title),children:(0,k.jsx)(k.Fragment,{children:Fn(e.title,50)})})}),(0,k.jsx)(Jt.A,{children:e.type}),(0,k.jsxs)(Jt.A,{children:[pn(null===e||void 0===e?void 0:e.currency),gn(Number(null===e||void 0===e?void 0:e.total))]}),(0,k.jsx)(Jt.A,{children:jn(e.date)}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Ln,{color:Rn[e.status],children:e.status})})]},e._id)))})]})})}),(0,k.jsx)(Re.A,{}),(0,k.jsx)(kn.A,{sx:{justifyContent:"flex-end"},children:(0,k.jsx)(pe.N_,{to:"/requisitions",children:(0,k.jsx)(Se.A,{sx:{color:"success.dark"},endIcon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(bn.A,{})}),size:"small",variant:"text",children:"View all"})})})]})]})};zn.prototype={latestReqs:fn().array,sx:fn().object};var Bn=n(1385),Hn=n(6494),Dn=n(611);const _n=e=>{const{totalValue:t,sx:n}=e,{user:i}=Ge(),[a,r]=(0,s.useState)(0),[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)("success.ppdc");return(0,s.useEffect)((()=>{(async()=>{try{l(!0);const e=(await dn(null===i||void 0===i?void 0:i.email)).data.totalCount,n=t;if(0===n)return void r(0);const s=Math.round(e/n*100);r(s),d(0===s?"success.ppdc":s>80?"error.main":s>50?"warning.main":s>30?"warning.light":"success.lightest")}catch(G){console.error("Error fetching unretired requisitions:",G.message)}finally{l(!1)}})()}),[t,null===i||void 0===i?void 0:i.email]),(0,k.jsx)(Cn.A,{sx:n,children:(0,k.jsxs)(Hn.A,{children:[(0,k.jsxs)(Ie.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,k.jsxs)(Ie.A,{spacing:1,children:[(0,k.jsx)(ve.A,{color:"text.secondary",gutterBottom:!0,variant:"overline",children:"Retirements Left"}),(0,k.jsxs)(ve.A,{variant:"h4",children:[o?(0,k.jsx)(wn.A,{color:"warning"}):0!==a&&Number(a.toFixed(2))+"%",0===Number(t)&&(0,k.jsx)("p",{style:{fontSize:"12px"},children:"No pending retirements"})]})]}),(0,k.jsx)(et.A,{sx:{backgroundColor:c,height:56,width:56},children:(0,k.jsx)(_e.A,{children:(0,k.jsx)(Bn.A,{})})})]}),(0,k.jsx)(je.A,{sx:{mt:3},children:(0,k.jsx)(Dn.A,{value:a,variant:"determinate",sx:{"& .MuiLinearProgress-bar":{backgroundColor:c}}})})]})})};var Tn=n(6267);const Wn=e=>{const{positive:t=!1,sx:n,value:s}=e;return(0,k.jsx)(Cn.A,{sx:n,children:(0,k.jsx)(Hn.A,{children:(0,k.jsxs)(Ie.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,k.jsxs)(Ie.A,{spacing:1,children:[(0,k.jsx)(ve.A,{color:"text.secondary",variant:"overline",children:"Total Raised"}),(0,k.jsx)(ve.A,{variant:"h4",children:s})]}),(0,k.jsx)(et.A,{sx:{backgroundColor:t?"success.main":"error.main",height:56,width:56},children:(0,k.jsx)(_e.A,{children:(0,k.jsx)(Tn.A,{})})})]})})})};var Un=n(4308);const On=e=>{const{sx:t,amounts:n,totalApproved:s}=e;return(0,k.jsx)(Cn.A,{sx:t,children:(0,k.jsx)(Hn.A,{children:(0,k.jsxs)(Ie.A,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,k.jsxs)(Ie.A,{spacing:1,children:[(0,k.jsx)(ve.A,{color:"text.secondary",variant:"overline",children:"Total Approved"}),(0,k.jsx)(je.A,{children:(0,k.jsx)(ve.A,{variant:"h4",children:s})})]}),(0,k.jsx)(et.A,{sx:{backgroundColor:"success.ppdc",height:56,width:56},children:(0,k.jsx)(_e.A,{children:(0,k.jsx)(Un.A,{})})})]})})})},Vn=()=>{Ct();const{user:e}=Ge(),[t,n]=(0,s.useState)(!0),[i,a]=(0,s.useState)([]),[r,o]=(0,s.useState)(0),[l,c]=(0,s.useState)(),[d,u]=(0,s.useState)(0);return(0,s.useEffect)((()=>{e&&null!==e&&void 0!==e&&e.email&&(async()=>{try{if(e&&e.email){const t=await cn(null===e||void 0===e?void 0:e._id),{requisitions:n,totalCount:s,totalAmount:i,totalApproved:r}=t.data;o(s),a(n.slice(0,6)),c(i),u(r)}n(!1)}catch(G){console.error("Error fetching requisitions:",G.message),n(!1)}})()}),[e,null===e||void 0===e?void 0:e.email]),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"xl",children:(0,k.jsxs)(Ae.A,{container:!0,spacing:3,children:[(0,k.jsx)(Ae.A,{xs:12,sm:6,lg:3,children:(0,k.jsx)(Wn,{positive:!0,sx:{height:"100%"},value:"".concat(r)})}),(0,k.jsx)(Ae.A,{xs:12,sm:6,lg:4,children:(0,k.jsx)(On,{difference:16,positive:!1,sx:{height:"100%"},value:"".concat(r),amounts:l,totalApproved:d})}),(0,k.jsx)(Ae.A,{xs:12,sm:6,lg:4,children:(0,k.jsx)(_n,{sx:{height:"100%"},totalValue:r})}),(0,k.jsx)(Ae.A,{xs:12,md:12,lg:12,children:(0,k.jsx)(zn,{latestReqs:i,sx:{height:"100%"},loading:t})})]})})})})},Gn=()=>{const e=window.localStorage.getItem("token");e?u.A.defaults.headers.common.Authorization=e:delete u.A.defaults.headers.common.Authorization},Yn=async e=>{try{Gn();return await u.A.post("".concat(x,"/upload-file"),e,{headers:{"Content-Type":"multipart/form-data"}})}catch(G){throw new Error(G.message)}};var Zn=n(1794);const Xn=()=>{const{user:e,setUser:t}=Ge(),[n,i]=(0,s.useState)(null),[a,r]=(0,s.useState)(null),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1);return(0,k.jsxs)(Cn.A,{children:[(0,k.jsx)(Hn.A,{children:(0,k.jsxs)(je.A,{sx:{alignItems:"center",display:"flex",flexDirection:"column"},children:[(0,k.jsx)(et.A,{src:null===e||void 0===e?void 0:e.photoUrl,sx:{height:80,mb:2,width:80}}),(0,k.jsx)(ve.A,{gutterBottom:!0,variant:"h5",children:null===e||void 0===e?void 0:e.name}),(0,k.jsx)(ve.A,{color:"text.secondary",variant:"body2",children:null===e||void 0===e?void 0:e.email}),(0,k.jsxs)(ve.A,{variant:"body2",children:["Role: ",ce(null===e||void 0===e?void 0:e.accessLevel)]})]})}),(0,k.jsx)(kn.A,{children:(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:[(0,k.jsx)(Se.A,{variant:"outlined",color:"info",onClick:()=>document.getElementById("upload-button").click(),children:"Upload picture"}),(0,k.jsx)("input",{accept:"png jpg jpeg",style:{display:"none"},id:"upload-button",type:"file",onChange:e=>{i(e.target.files[0])}})]})}),n&&(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"space-around"},children:[(0,k.jsx)("img",{src:URL.createObjectURL(n),alt:"Preview",style:{width:"50px",height:"50px",marginLeft:"10px"}}),(0,k.jsx)(Se.A,{variant:"text",color:"success",onClick:async()=>{try{l(!0);const s=new FormData;s.append("files",n),s.append("destination","profile-photos");const a=await Yn(s),{imageUrls:r}=await a.data,o=r[0].imageUrl,c=await(async(e,t)=>{try{return await A("".concat("update-user-photo","/").concat(e),{imageUrl:t})}catch(G){throw new Error(G.message)}})(e._id,o);if(200===c.status){const n={...e,photoUrl:o};t(n),ne.oR.success("You've changed your profile photo!"),i(null)}}catch(G){ne.oR.error("Error uploading image"),console.error("Error uploading image:",G)}finally{l(!1)}},disabled:o,children:o?"Saving...":"Save Picture"}),(0,k.jsx)(Se.A,{color:"error",onClick:()=>i(null),children:(0,k.jsx)(Zn.A,{})})]}),(0,k.jsx)("hr",{}),(0,k.jsxs)(ft.A,{children:[(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center",flexDirection:"column"}}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center"},children:(0,k.jsxs)("figure",{children:[(0,k.jsx)("figcaption",{children:(0,k.jsx)(ve.A,{color:"text.secondary",variant:"body2",children:"Your Signature"})}),(0,k.jsx)("img",{src:null===e||void 0===e?void 0:e.signatureUrl,alt:"",width:100})]})}),(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:[(0,k.jsx)(Se.A,{variant:"text",color:"info",sx:{textAlign:"center"},onClick:()=>document.getElementById("upload-sig-button").click(),children:"Upload Signature"}),(0,k.jsx)("input",{accept:"png jpg jpeg",style:{display:"none"},id:"upload-sig-button",type:"file",onChange:e=>{r(e.target.files[0])}})]}),(0,k.jsx)(Re.A,{sx:{my:2}}),a&&(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,k.jsx)("img",{src:URL.createObjectURL(a),alt:"Preview",style:{width:"80px",height:"50px",marginLeft:"10px"}}),(0,k.jsx)(Se.A,{variant:"text",color:"success",onClick:async()=>{try{d(!0);const n=new FormData;n.append("files",a),n.append("destination","signature-photos");const s=await Yn(n),{imageUrls:i}=await s.data,o=i[0].imageUrl,l=await(async(e,t)=>{try{return await A("".concat("update-user-signature","/").concat(e),{imageUrl:t})}catch(G){throw new Error(G.message)}})(e._id,o);if(200===l.status){const n={...e,signatureUrl:o};ne.oR.success("You've added your signature!"),t(n),r(null)}}catch(G){console.error("Error uploading image:",G),ne.oR.error("Error uploading image")}finally{d(!1)}},disabled:c,children:c?"Saving...":"Save Signature"}),(0,k.jsx)(Se.A,{color:"error",onClick:()=>r(null),children:(0,k.jsx)(Zn.A,{})})]})]})]})},Jn=()=>{const{user:e}=Ge(),[t,n]=(0,s.useState)({firstName:e.name.split(" ")[0],lastName:e.name.split(" ")[1],email:null===e||void 0===e?void 0:e.email,password:"",repeatPassword:"",newPassword:""}),i=(0,s.useCallback)((e=>{n((t=>({...t,[e.target.name]:e.target.value})))}),[]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("form",{autoComplete:"off",noValidate:!0,children:(0,k.jsxs)(Cn.A,{children:[(0,k.jsx)(Sn.A,{subheader:"You can change your password, photo and signature",title:"Profile"}),(0,k.jsx)(Hn.A,{sx:{pt:0},children:(0,k.jsx)(je.A,{sx:{m:-1.5},children:(0,k.jsxs)(Ae.A,{container:!0,spacing:3,children:[(0,k.jsx)(Ae.A,{xs:12,md:6,children:(0,k.jsx)(Rt.A,{fullWidth:!0,helperText:"Please specify the first name",label:"First name",name:"firstName",onChange:i,disabled:!0,value:t.firstName})}),(0,k.jsx)(Ae.A,{xs:12,md:6,children:(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Last name",name:"lastName",onChange:i,disabled:!0,value:t.lastName})}),(0,k.jsx)(Ae.A,{xs:12,md:12,children:(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Email Address",name:"email",onChange:i,disabled:!0,value:t.email})}),(0,k.jsx)(Ae.A,{xs:12,md:12,children:(0,k.jsx)(Re.A,{})})]})})})]})})})},$n=()=>(Ct(),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"lg",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsx)("div",{children:(0,k.jsx)(ve.A,{variant:"h4",children:"Account"})}),(0,k.jsx)("div",{children:(0,k.jsxs)(Ae.A,{container:!0,spacing:3,children:[(0,k.jsx)(Ae.A,{xs:12,md:6,lg:4,children:(0,k.jsx)(Xn,{})}),(0,k.jsx)(Ae.A,{xs:12,md:6,lg:8,children:(0,k.jsx)(Jn,{})})]})})]})})})}));var Kn=n(1159);const Qn=e=>{let{onAddNew:t}=e;const{user:n}=Ge(),[i,a]=(0,s.useState)(!1),[r,o]=(0,s.useState)(""),[l,c]=(0,s.useState)(""),d=()=>{o(""),c(""),a(!1)};return(0,k.jsxs)(k.Fragment,{children:[["finance","financeReviewer","tech"].includes(n.accessLevel)&&(0,k.jsx)(Se.A,{variant:"outlined",sx:{color:W.main},onClick:()=>{a(!0)},children:"Add New Code"}),(0,k.jsxs)(Ce.A,{open:i,onClose:d,children:[(0,k.jsx)(Dt.A,{children:"Add New Account Code"}),(0,k.jsxs)(_t.A,{children:[(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Code Value",value:r,onChange:e=>o(e.target.value),variant:"outlined",sx:{mb:2}}),(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Description",value:l,onChange:e=>c(e.target.value),variant:"outlined",sx:{mb:2}})]}),(0,k.jsxs)(Wt.A,{children:[(0,k.jsx)(Se.A,{color:"error",onClick:d,children:"Cancel"}),(0,k.jsx)(Se.A,{color:"success",onClick:async()=>{t({value:r,description:l}),d()},variant:"contained",children:"Add Code"})]})]})]})},es=()=>{const[e,t]=(0,s.useState)([]),[n,i]=(0,s.useState)(null),[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[x,h]=(0,s.useState)(0),[m,p]=(0,s.useState)(20);(0,s.useEffect)((()=>{(async()=>{const e=await u.A.get(En);t(e.data)})()}),[e]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,md:6,children:(0,k.jsx)(Rt.A,{label:"Search Account Codes",value:c,onChange:e=>{d(e.target.value)},variant:"outlined",fullWidth:!0,sx:{my:2}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,md:6,sx:{display:"flex",alignItems:"center"},children:(0,k.jsx)(Qn,{onAddNew:async e=>{try{if(200===(await u.A.post(En,e)).status){const e=await u.A.get(En);t(e.data),ne.oR.success("New code added")}}catch(G){console.error("Error adding account code:",G)}}})})]}),e&&e.length>0?(0,k.jsxs)(k.Fragment,{children:[0===e.filter((e=>e.description.toLowerCase().includes(c.toLowerCase()))).length&&(0,k.jsx)(ve.A,{sx:{mt:2},children:"No account codes found for this query."}),(0,k.jsx)(Gt.A,{children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"30%"},children:"Code"}),(0,k.jsx)(Jt.A,{sx:{width:"40%"},children:"Description"}),(0,k.jsx)(Jt.A,{sx:{width:"30%"},children:"Action"})]})}),(0,k.jsx)($t.A,{children:e.filter((e=>e.description.toLowerCase().includes(c.toLowerCase()))).slice(x*m,x*m+m).map((s=>(0,k.jsxs)(Xt.A,{sx:n===s._id?{border:"1px solid #0B815A"}:{"&:hover":{backgroundColor:"#F5F7FF"}},children:[(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)(Rt.A,{defaultValue:s.value,onChange:e=>r(e.target.value)}):s.value}),(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)(Rt.A,{defaultValue:s.description,onChange:e=>l(e.target.value)}):s.description}),(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)($e.A,{onClick:()=>(async t=>{const n=e.find((e=>e._id===t));try{a&&(n.value=Number(a)),o&&(n.description=o),await u.A.put("".concat(En,"/").concat(t),n)}catch(G){console.error("Error updating account code:",G)}finally{i(null)}})(s._id),"aria-label":"save",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"success",children:(0,k.jsx)(Kt.A,{})})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ke.A,{title:"Delete",children:(0,k.jsx)($e.A,{onClick:()=>(async n=>{try{await u.A.delete("".concat(En,"/").concat(n));const s=e.filter((e=>e._id!==n));t(s),ne.oR.success("Code deleted")}catch(G){ne.oR.error(G.message)}})(s._id),"aria-label":"delete",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"error",children:(0,k.jsx)(Qt.A,{})})})}),(0,k.jsx)(Ke.A,{title:"Edit",children:(0,k.jsx)($e.A,{onClick:()=>{return e=s._id,void i(e);var e},"aria-label":"edit",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"info",children:(0,k.jsx)(en.A,{})})})})]})})]},s._id)))})]})}),(0,k.jsx)(Kn.A,{rowsPerPageOptions:[20,50,100],component:"div",count:e.length,rowsPerPage:m,page:x,onPageChange:(e,t)=>{h(t)},onRowsPerPageChange:e=>{p(parseInt(e.target.value,10)),h(0)}})]}):(0,k.jsx)(ve.A,{sx:{mt:2},children:"No Accounts found."})]})},ts=e=>{let{onAddNew:t}=e;const[n,i]=(0,s.useState)(!1),[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),u=()=>{r(""),d(""),i(!1)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{variant:"outlined",sx:{color:W.main},onClick:()=>{i(!0)},children:"Add New Code"}),(0,k.jsxs)(Ce.A,{open:n,onClose:u,children:[(0,k.jsx)(Dt.A,{children:"New Budget Code"}),(0,k.jsxs)(_t.A,{children:[(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Code Value",value:a,onChange:e=>r(e.target.value),variant:"outlined",sx:{my:2}}),(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Project",value:o,onChange:e=>l(e.target.value),variant:"outlined",sx:{mb:2}}),(0,k.jsx)(Rt.A,{fullWidth:!0,label:"Description",value:c,onChange:e=>d(e.target.value),variant:"outlined"})]}),(0,k.jsxs)(Wt.A,{children:[(0,k.jsx)(Se.A,{color:"error",onClick:u,children:"Cancel"}),(0,k.jsx)(Se.A,{color:"success",onClick:async()=>{t({code:a,project:o,description:c}),u()},variant:"contained",children:"Add Code"})]})]})]})},ns=()=>{const[e,t]=(0,s.useState)([]),[n,i]=(0,s.useState)(null),[a,r]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[x,h]=(0,s.useState)([]);console.log(x);const[m,p]=(0,s.useState)(""),[g,j]=(0,s.useState)(0),[A,v]=(0,s.useState)(20);(0,s.useEffect)((()=>{(async()=>{const e=await u.A.get(In);t(e.data)})()}),[e]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,md:6,children:(0,k.jsx)(Rt.A,{label:"Search Budget",value:m,onChange:e=>{p(e.target.value)},variant:"outlined",fullWidth:!0,sx:{my:2}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,md:6,sx:{display:"flex",alignItems:"center"},children:(0,k.jsx)(ts,{onAddNew:async e=>{try{if(200===(await u.A.post(In,e)).status){const e=await u.A.get(In);h(e.data),ne.oR.success("New code added")}}catch(G){console.error("Error adding code:",G)}}})})]}),e&&e.length>0?(0,k.jsxs)(k.Fragment,{children:[0===e.filter((e=>e.description.toLowerCase().includes(m.toLowerCase()))).length&&(0,k.jsx)(ve.A,{sx:{mt:2},children:"No account codes found for this query."}),(0,k.jsx)(Gt.A,{children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Code"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Project"}),(0,k.jsx)(Jt.A,{sx:{width:"40%"},children:"Description"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Action"})]})}),(0,k.jsx)($t.A,{children:e.filter((e=>e.description.toLowerCase().includes(m.toLowerCase()))).slice(g*A,g*A+A).map((s=>(0,k.jsxs)(Xt.A,{sx:n===s._id?{border:"1px solid #0B815A"}:{"&:hover":{backgroundColor:"#F5F7FF"}},children:[(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)(Rt.A,{defaultValue:s.code,onChange:e=>r(e.target.value)}):s.code}),(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)(Rt.A,{defaultValue:s.project,onChange:e=>l(e.target.value)}):s.project}),(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)(Rt.A,{defaultValue:s.description,onChange:e=>d(e.target.value)}):s.description}),(0,k.jsx)(Jt.A,{children:n===s._id?(0,k.jsx)($e.A,{onClick:()=>(async t=>{const n=e.find((e=>e._id===t));try{return a&&(n.code=Number(a)),o&&(n.project=o),c&&(n.description=c),console.log(n)}catch(G){console.error("Error updating account code:",G)}finally{i(null)}})(s._id),"aria-label":"save",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"success",children:(0,k.jsx)(Kt.A,{})})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ke.A,{title:"Delete",children:(0,k.jsx)($e.A,{onClick:()=>(async n=>{try{await u.A.delete("".concat(In,"/").concat(n));const s=e.filter((e=>e._id!==n));t(s),ne.oR.success("Code deleted")}catch(G){ne.oR.error(G.message)}})(s._id),"aria-label":"delete",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"error",children:(0,k.jsx)(Qt.A,{})})})}),(0,k.jsx)(Ke.A,{title:"Edit",children:(0,k.jsx)($e.A,{onClick:()=>{return e=s._id,void i(e);var e},"aria-label":"edit",children:(0,k.jsx)(_e.A,{fontSize:"small",color:"info",children:(0,k.jsx)(en.A,{})})})})]})})]},s._id)))})]})}),(0,k.jsx)(Kn.A,{rowsPerPageOptions:[20,50,100],component:"div",count:e.length,rowsPerPage:A,page:g,onPageChange:(e,t)=>{j(t)},onRowsPerPageChange:e=>{v(parseInt(e.target.value,10)),j(0)}})]}):(0,k.jsx)(ve.A,{sx:{mt:2},children:"No Accounts found."})]})};var ss=n(3766),is=n(6605),as=n(710),rs=n(1337);const os=()=>{const[e,t]=(0,s.useState)(!1),[n,i]=(0,s.useState)([]),[a,r]=(0,s.useState)(!1),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[x,h]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[g,j]=(0,s.useState)(""),[A,v]=(0,s.useState)(!1),y=async()=>{const e=await u.A.get(Pn);i(e.data)};(0,s.useEffect)((()=>{y()}),[n]);const f=()=>{r(!1)};return(0,k.jsx)(k.Fragment,{children:n&&n.length>0?(0,k.jsxs)(Cn.A,{sx:{p:2},children:[(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,k.jsx)(ve.A,{sx:{my:3},variant:"h6",children:"Projects"}),(0,k.jsx)(je.A,{children:(0,k.jsx)(Se.A,{variant:"outlined",sx:{color:W.main},onClick:()=>{r(!0)},className:"btn btn-type-info btn-md",children:"Add new Project"})})]}),(0,k.jsx)(It.A,{open:a,onClose:f,children:(0,k.jsx)(je.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"5px"},children:(0,k.jsxs)(je.A,{sx:{p:2},children:[(0,k.jsx)(ve.A,{variant:"body1",sx:{mb:2},children:"Add a new Project"}),(0,k.jsx)(Rt.A,{name:"projectName",label:"Project Name",value:o,onChange:e=>l(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),(0,k.jsx)(Rt.A,{name:"funder",label:"Funder",value:c,onChange:e=>d(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),(0,k.jsx)(Tt.A,{options:Ut.map((e=>e.bankName)),renderInput:e=>(0,k.jsx)(Rt.A,{...e,name:"bankName",label:"Bank Name",value:g,onChange:e=>j(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),onInputChange:(e,t)=>{j(t)}}),(0,k.jsx)(Rt.A,{name:"accountNumber",label:"Account Number",value:m,onChange:e=>p(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),(0,k.jsx)(Rt.A,{name:"accountName",label:"Account Name",value:x,onChange:e=>h(e.target.value),fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),(0,k.jsx)(Se.A,{onClick:async()=>{try{v(!0);const e={funder:c,projectName:o,account:{bankName:g,accountName:x,accountNumber:m}};await u.A.post(Pn,e),y(),ne.oR.success("".concat(o," project created!")),f()}catch(G){ne.oR.error("Failed to create project:",G.message)}finally{v(!1)}},color:"success",variant:"contained",disabled:A,children:A?"adding...":"Add Project"})]})})}),n&&n.map(((n,s)=>{var i,a,r,o,l;return(0,k.jsxs)(ss.A,{expanded:e==="panel".concat(Number(s)+1),onChange:(l="panel".concat(Number(s)+1),(e,n)=>{t(!!n&&l)}),sx:{borderTop:"0.5px solid #83c5be"},children:[(0,k.jsxs)(is.A,{expandIcon:(0,k.jsx)(rs.A,{}),"aria-controls":"panel".concat(Number(s)+1,"bh-content"),id:"panel".concat(Number(s)+1,"bh-header"),children:[(0,k.jsx)(ve.A,{component:"span",sx:{width:"33%",flexShrink:0,borderLeft:e==="panel".concat(Number(s)+1)?"5px solid #83c5be":"none",paddingLeft:e==="panel".concat(Number(s)+1)?"5px":"initial"},children:null===n||void 0===n?void 0:n.projectName}),(0,k.jsxs)(ve.A,{component:"span",sx:{color:"text.secondary"},children:[(0,k.jsx)("strong",{children:"Funder: "})," ",null===n||void 0===n?void 0:n.funder]})]}),(0,k.jsx)(as.A,{sx:{bgcolor:"#f5f5f5"},children:(0,k.jsxs)(je.A,{sx:{flexGrow:1},children:[(0,k.jsxs)(Et.Ay,{component:"span",container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{component:"span",item:!0,xs:6,md:4,children:(0,k.jsxs)(je.A,{sx:{mr:2},children:[(0,k.jsx)(ve.A,{component:"span",variant:"body2",display:"block",gutterBottom:!0,className:"text-item-header",children:"Bank name"}),(0,k.jsx)(ve.A,{component:"span",variant:"body1",className:"text-item",children:null===n||void 0===n||null===(i=n.account)||void 0===i?void 0:i.bankName})]})}),(0,k.jsx)(Et.Ay,{component:"span",item:!0,xs:6,md:4,children:(0,k.jsxs)(je.A,{sx:{mr:2},children:[(0,k.jsx)(ve.A,{component:"span",variant:"body2",display:"block",gutterBottom:!0,className:"text-item-header",children:"Account number"}),(0,k.jsx)(ve.A,{component:"span",variant:"body1",className:"text-item",children:null===n||void 0===n||null===(a=n.account)||void 0===a?void 0:a.accountNumber})]})}),(0,k.jsx)(Et.Ay,{component:"span",item:!0,xs:6,md:4,children:(0,k.jsxs)(je.A,{sx:{mr:2},children:[(0,k.jsx)(ve.A,{component:"span",variant:"body2",display:"block",gutterBottom:!0,className:"text-item-header",children:"Account name"}),(0,k.jsx)(ve.A,{component:"span",variant:"body1",className:"text-item",children:null===n||void 0===n||null===(r=n.account)||void 0===r?void 0:r.accountName})]})}),(0,k.jsx)(Et.Ay,{component:"span",item:!0,xs:6,md:8,children:(0,k.jsxs)(je.A,{sx:{mr:2},children:[(0,k.jsx)(ve.A,{component:"span",variant:"body2",display:"block",gutterBottom:!0,className:"text-item-header",children:"Balance"}),(0,k.jsx)(ve.A,{component:"span",variant:"body1",className:"text-item",children:(null===n||void 0===n||null===(o=n.account)||void 0===o?void 0:o.balance)||"N/A"})]})})]}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"end"},children:(0,k.jsx)(Se.A,{onClick:()=>alert("Contact Tech to delete the ".concat(n.projectName," project")),color:"error",children:"Delete"})})]})})]},s)}))]}):(0,k.jsx)(ve.A,{sx:{mt:2},children:"No projects found."})})},ls=()=>{Ct();const[e,t]=(0,s.useState)(0);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"lg",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsx)(je.A,{children:(0,k.jsx)(ve.A,{variant:"h5",children:"Projects & Codes"})}),(0,k.jsxs)(je.A,{children:[(0,k.jsxs)(Lt.A,{value:e,onChange:(e,n)=>{t(n)},indicatorColor:"primary",children:[(0,k.jsx)(Ft.A,{label:"Projects"}),(0,k.jsx)(Ft.A,{label:"Account Codes"}),(0,k.jsx)(Ft.A,{label:"Budget Codes"})]}),0===e&&(0,k.jsx)(je.A,{sx:{mt:2},children:(0,k.jsx)(os,{})}),1===e&&(0,k.jsx)(je.A,{sx:{mt:2},children:(0,k.jsx)(es,{})}),2===e&&(0,k.jsx)(je.A,{sx:{mt:2},children:(0,k.jsx)(ns,{})})]})]})})})})};var cs=n(7254),ds=n(490),us=n(3193),xs=n(1342),hs=n(5174),ms=n(5721),ps=n(8266),gs=n(2453),js=n(9531),As=n(7098),vs=n(3723);const ys="projects",fs="budget-codes";var bs=n(8638);const ws=e=>{let{open:t,onClose:n,isEditMode:i,retireMode:a,requisitionData:r,triggerUpdateRequisition:o}=e;const{user:l}=Ge(),[c,d]=(0,s.useState)(1),[h,m]=(0,s.useState)(""),[A,v]=(0,s.useState)(""),[y,f]=(0,s.useState)(""),[b,w]=(0,s.useState)("NGN"),[C,N]=(0,s.useState)(!1),[L,F]=(0,s.useState)(!1),[R,I]=(0,s.useState)(!1),[E,P]=(0,s.useState)(!1),[q,M]=(0,s.useState)(""),[z,B]=(0,s.useState)(""),[H,D]=(0,s.useState)("");let _=[];const[T,W]=(0,s.useState)([]),[U,O]=(0,s.useState)(0),[V,Y]=(0,s.useState)([]),[Z,X]=(0,s.useState)([]),[J,$]=(0,s.useState)([]),[K,Q]=(0,s.useState)([]),[ee,te]=(0,s.useState)(""),[se,ie]=(0,s.useState)([]),[ae,oe]=(0,s.useState)(""),[le,ce]=(0,s.useState)({}),[de,ue]=(0,s.useState)(""),[xe,he]=(0,s.useState)(""),[me,pe]=(0,s.useState)(""),[ge,Ae]=(0,s.useState)([]),[ye,fe]=(0,s.useState)([]),[be,we]=(0,s.useState)(!1),[ke,Ne]=(0,s.useState)(!1);(0,s.useEffect)((()=>{r&&(m(r.projectName?r.projectName:r.projectChargedTo?r.projectChargedTo.projectName:""),v(r.type||""),f(r.title||""),w(r.currency||""),W(r.items),X(r.invoices||""),O(Number(r.total)||0))}),[r]);(0,s.useEffect)((()=>{(async()=>{try{const[t,n,s,i]=await Promise.all([S(),(e=l._id,g("".concat(nn,"/user/").concat(e))),g(ys),g(fs)]);if(t&&t.data){const{budget_holders:e}=t.data;Q(e)}ie(n.data),Ae(s.data),fe(i.data)}catch(G){console.error(G)}var e})()}),[]),(0,s.useEffect)((()=>{H&&_.push(H)}),[H]);const Le=()=>{M(""),B(""),D(""),_=[],W([]),O(0),Y([]),X([]),Q([]),te(""),ie([]),oe(""),ce({}),ue(""),he(""),pe(""),Ae([]),fe([])},Fe=ge.find((e=>e.projectName===h)),[Ie,Ee]=(0,s.useState)({});(0,s.useEffect)((()=>{h&&Fe&&Ee({account:{accountName:Fe?Fe.account.accountName:"",accountNumber:Fe?Fe.account.accountNumber:"",bankName:Fe?Fe.account.bankName:""},funder:Fe?Fe.funder:"",projectName:h})}),[h,Fe]);const Pe=async e=>{e.preventDefault();try{I(!0);const e=K.find((e=>e.name===ee)),s={userId:l._id,type:A,title:y,invoices:Z,items:T,currency:b,amountInWords:"",total:Number(U),accountName:(null===le||void 0===le?void 0:le.accountName)||me||"Nil",accountNumber:(null===le||void 0===le?void 0:le.accountNumber)||xe||"Nil",bankName:(null===le||void 0===le?void 0:le.bankName)||de||"Nil",attentionTo:(null===e||void 0===e?void 0:e.email)||"",projectChargedTo:Ie,budgetLineItems:_,date:re()};if(!s.type)return void ne.oR.warning("Type is missing");if(!s.title)return void ne.oR.warning("Title is missing");if(!s.items||s.items.length<1)return void ne.oR.warning("No items added");if(!s.attentionTo)return void ne.oR.warning("Attention to is missing");if(!Fe)return void ne.oR.warning("Please select a project");201===(await(t=s,p(rn,t))).status&&(ne.oR.success("Request created successfully"),n(),Le())}catch(G){ne.oR.error("Error creating request\n".concat(G.message)),console.log("Error creating request",G.message)}finally{I(!1),d(1)}var t},qe=async e=>{e.preventDefault();try{P(!0);const e={userId:l._id,invoices:r.invoices.length>0?[...r.invoices,...J]:J,date:re()},i=await(t=r._id,s=e,j("user-requisitions/retire/".concat(t),s));200===i.status&&(ne.oR.success("Request sent for retirement"),o(i.data),n())}catch(G){console.log("Failed to save changes",G.message)}finally{P(!1)}var t,s},Me=()=>{n(),d(1)},ze=async(e,t)=>{try{const n=await(async e=>{try{return Gn(),await u.A.delete("".concat(x,"/remove-file"),{data:{publicId:e},headers:{"Content-Type":"application/json"}})}catch(G){throw console.error("Error removing file:",G.message),new Error(G.message)}})(t);204===n.status&&(a?$((t=>t.filter(((t,n)=>n!==e)))):X((t=>t.filter(((t,n)=>n!==e)))))}catch(G){ne.oR.error("Error deleting file: ".concat(G.message)),console.log("Error deleting file:",G.message)}},Be=e=>{window.open(e.url)};return(0,k.jsxs)(Ce.A,{open:t,onClose:n,maxWidth:"md",fullWidth:!0,children:[(0,k.jsxs)(Dt.A,{sx:{my:2},children:[i?"Edit Requisition":a?"Retire Requisition":"Create Requisition",(0,k.jsx)(ve.A,{variant:"subtitle1",children:"Step ".concat(c)})]}),(0,k.jsxs)(_t.A,{children:[1===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:6,children:(0,k.jsx)(us.A,{fullWidth:!0,children:a?(0,k.jsx)(Rt.A,{disabled:!0,type:"text",value:h||"",variant:"outlined"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xs.A,{children:"Select Project"}),(0,k.jsx)(hs.A,{label:"Select Project",value:h,onChange:e=>m(e.target.value),children:ge.map((e=>(0,k.jsx)(ht.A,{value:e.projectName,children:e.projectName},e._id)))})]})})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,children:(0,k.jsx)(us.A,{fullWidth:!0,children:a?(0,k.jsx)(Rt.A,{disabled:!0,type:"text",value:A||"",variant:"outlined"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xs.A,{children:"Request Type"}),(0,k.jsxs)(hs.A,{label:"Request Type",value:A,onChange:e=>v(e.target.value),children:[(0,k.jsx)(ht.A,{value:"Advance",children:"Advance"}),(0,k.jsx)(ht.A,{value:"Petty",children:"Petty"}),(0,k.jsx)(ht.A,{value:"Reimbursement",children:"Reimbursement"})]})]})})})]}),(0,k.jsx)(Rt.A,{multiline:!0,rows:4,fullWidth:!0,label:"Description",variant:"outlined",margin:"normal",value:y,disabled:a,onChange:e=>f(e.target.value)}),(0,k.jsxs)(je.A,{sx:{mt:4},children:[(0,k.jsx)(Et.Ay,{container:!0,spacing:2,sx:{mt:1},children:(0,k.jsx)(Et.Ay,{item:!0,xs:3,children:(0,k.jsx)(us.A,{fullWidth:!0,children:a?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xs.A,{children:"Choose Currency"}),(0,k.jsxs)(hs.A,{value:b,onChange:e=>w(e.target.value),children:[(0,k.jsx)(ht.A,{value:"NGN",children:"\u20a6"}),(0,k.jsx)(ht.A,{value:"USD",children:"$"})]})]})})})}),a?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ve.A,{sx:{mt:3},variant:"subtitle2",children:"Add Items"}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(us.A,{fullWidth:!0,sx:{mt:1},children:(0,k.jsx)(Rt.A,{label:"Enter desc",value:q,onChange:e=>M(e.target.value),variant:"outlined",fullWidth:!0})})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(us.A,{fullWidth:!0,sx:{mt:1},children:(0,k.jsx)(Rt.A,{label:"Enter amount",type:"number",value:z,onChange:e=>B(e.target.value),variant:"outlined",fullWidth:!0})})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(us.A,{fullWidth:!0,sx:{mt:1},children:(0,k.jsx)(Tt.A,{fullWidth:!0,options:ye.filter((e=>e.project.includes(h)?e:ye)),getOptionLabel:e=>e?"".concat(e.code,"-(").concat(e.project,")-").concat(e.description):"",value:H,onChange:(e,t)=>{D(t)},renderInput:e=>(0,k.jsx)(Rt.A,{...e,label:"Budget Line",fullWidth:!0})})})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,sx:{mt:0},children:(0,k.jsx)(Se.A,{variant:"outlined",color:"success",size:"medium",onClick:()=>{try{const e={title:q,amount:z,code:H.code};let t=Number(U)||0;e.title&&e.amount&&(W([...T,e]),t+=Number(z),O(t),M(""),B(""),D(""))}catch(G){ne.oR.error("Failed to add item",G.message)}},children:"Save Item"})})]})]}),T.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ve.A,{variant:"subtitle1",sx:{mt:2},children:"Items List"}),(0,k.jsx)(Gt.A,{component:an.A,children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:"Title"}),(0,k.jsx)(Jt.A,{children:"Amount"}),(0,k.jsx)(Jt.A,{children:"Budget Line"}),!a&&(0,k.jsx)(Jt.A,{children:"Action"})]})}),(0,k.jsx)($t.A,{children:T.map(((e,t)=>(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:e.title}),(0,k.jsx)(Jt.A,{children:e.amount}),(0,k.jsx)(Jt.A,{children:e.code}),a?(0,k.jsx)(Jt.A,{children:(0,k.jsx)($e.A,{"aria-label":"Preview",color:"error",disabled:!0,sx:{fontSize:"1rem"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(vs.A,{})})})}):(0,k.jsx)(Jt.A,{children:(0,k.jsx)($e.A,{onClick:()=>(e=>{if(e>=0&&e<T.length){const t=T[e],n=Number(U)-Number(t.amount),s=[...T];s.splice(e,1),W(s),O(n)}})(t),"aria-label":"Preview",color:"error",sx:{fontSize:"1rem"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Oe.A,{})})})})]},t)))})]})})]})]}),(0,k.jsx)(Et.Ay,{container:!0,spacing:2,sx:{mt:1},children:(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsx)(ve.A,{children:(0,k.jsxs)("strong",{children:["Total amount:\xa0",b,"\xa0",gn(Number(U))]})})})})]}),2===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:12,md:6,children:[(0,k.jsx)(ve.A,{variant:"subtitle1",sx:{mt:2},children:"Upload supporting documents:(receipts, invoices, etc)"}),(0,k.jsxs)(ve.A,{variant:"body2",sx:{color:"text.secondary",mt:1},children:["Please for multiple files, hold down the Ctrl/cmd key and select a maximum of 5 files.",(0,k.jsx)("br",{}),"Don't forget to press the Upload button after selecting file(s)."]})," "]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,md:6,children:[" ",(0,k.jsx)("input",{type:"file",id:"fileInput",accept:".jpg, .jpeg, .png, .pdf, .xls, .xlsx",multiple:!0,style:{display:"none"},onChange:e=>{const t=e.target.files;Y([...V,...Array.from(t)])}}),(0,k.jsxs)("label",{htmlFor:"fileInput",children:[(0,k.jsx)(Se.A,{variant:"outlined",component:"span",color:"success",startIcon:(0,k.jsx)(gs.A,{}),sx:{mt:2},children:"Select File(s)"}),(0,k.jsxs)(Se.A,{variant:"contained",color:"success",sx:{mt:2,ml:1},disabled:C||0===V.length,onClick:e=>(async e=>{e.preventDefault();try{if(a){N(!0);const e=new FormData,t=[];e.append("destination","invoices");for(let i=0;i<V.length;i++)e.append("files",V[i]),t.push({name:V[i].name});const n=await Yn(e),{imageUrls:s}=await n.data;for(let i=0;i<s.length;i++)t[i].url=s[i].imageUrl,t[i].id=s[i].public_id;$([...J,...t]),Y([]),F(!0),setTimeout((()=>{F(!1)}),3e3)}else{N(!0);const e=new FormData,t=[];e.append("destination","invoices");for(let i=0;i<V.length;i++)e.append("files",V[i]),t.push({name:V[i].name});const n=await Yn(e),{imageUrls:s}=await n.data;for(let i=0;i<s.length;i++)t[i].url=s[i].imageUrl,t[i].id=s[i].public_id;X([...Z,...t]),Y([]),F(!0),setTimeout((()=>{F(!1)}),3e3)}}catch(G){ne.oR.error("Error uploading files"),console.log("Error uploading files:",G.message)}finally{N(!1)}})(e),children:["Upload",L?"ed":"",C&&(0,k.jsx)(wn.A,{size:20,sx:{color:"green",position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}}),"\xa0",L&&(0,k.jsx)(bs.A,{})]})]})]})]}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:4,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:12,md:6,children:[V&&V.length>0&&(0,k.jsx)(ve.A,{variant:"subtitle1",sx:{mt:2},children:"Selected Files"}),(0,k.jsx)(ms.A,{children:V.map(((e,t)=>(0,k.jsxs)(at.Ay,{sx:{mt:-1},children:[(0,k.jsx)(rt.A,{primary:e.name}),(0,k.jsxs)(ps.A,{children:[(0,k.jsx)($e.A,{onClick:()=>(e=>{window.open(URL.createObjectURL(e))})(e),"aria-label":"Preview",color:"primary",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(js.A,{})})}),(0,k.jsx)($e.A,{onClick:()=>(e=>{const t=[...V];t.splice(e,1),Y(t)})(t),"aria-label":"Remove",color:"error",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(As.A,{})})})]})]},t)))})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,md:6,children:[Z&&Z.length>0&&(0,k.jsx)(ve.A,{variant:"subtitle1",sx:{mt:2},children:"Uploaded Files"}),a&&(0,k.jsx)(ms.A,{children:J.map(((e,t)=>(0,k.jsxs)(at.Ay,{sx:{mt:-1},children:[(0,k.jsx)(rt.A,{primary:e.name}),(0,k.jsxs)(ps.A,{children:[(0,k.jsx)($e.A,{onClick:()=>Be(e),"aria-label":"Preview",color:"primary",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(js.A,{})})}),(0,k.jsx)($e.A,{onClick:()=>ze(t,e.id),"aria-label":"Delete",color:"error",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Oe.A,{})})})]})]},t)))}),a&&(0,k.jsx)(Re.A,{sx:{borderColor:"neutral.300"}}),(0,k.jsx)(ms.A,{children:Z.map(((e,t)=>(0,k.jsxs)(at.Ay,{sx:{mt:-1},children:[(0,k.jsx)(rt.A,{primary:e.name}),(0,k.jsxs)(ps.A,{children:[(0,k.jsx)($e.A,{onClick:()=>Be(e),"aria-label":"Preview",color:"primary",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(js.A,{})})}),a?(0,k.jsx)($e.A,{disabled:!0,"aria-label":"Cannot Delete",color:"error",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(vs.A,{})})}):(0,k.jsx)($e.A,{onClick:()=>ze(t,e.id),"aria-label":"Delete",color:"error",sx:{fontSize:"10px"},children:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(Oe.A,{})})})]})]},t)))})]})]}),(0,k.jsx)(Re.A,{sx:{my:3,borderColor:"neutral.300"}}),!a&&(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:6,children:(0,k.jsx)(Tt.A,{options:se.map((e=>e.accountName)),renderInput:e=>(0,k.jsx)(Rt.A,{...e,name:"beneficiary",label:"Select Beneficiary",value:ae,fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),onInputChange:(e,t)=>{oe(e.target.value),ce(se.find((e=>e.accountName===t))||{})}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:6,children:(0,k.jsx)(Tt.A,{options:K.map((e=>e.name)),renderInput:e=>(0,k.jsx)(Rt.A,{...e,name:"attentionTo",label:"Attention To",value:ee,fullWidth:!0,required:!0,sx:{marginBottom:"1rem"}}),onInputChange:(e,t)=>te(t)})})]}),(0,k.jsxs)(k.Fragment,{children:[le&&le.accountName&&le.accountNumber&&le.bankName&&(0,k.jsxs)("div",{children:[(0,k.jsxs)(ve.A,{variant:"subtitle1",sx:{mt:2},children:["Holder:\xa0",(0,k.jsx)("strong",{children:le.accountName})]}),(0,k.jsxs)(ve.A,{variant:"subtitle1",children:["Account Number:\xa0",(0,k.jsx)("strong",{children:le.accountNumber})]}),(0,k.jsxs)(ve.A,{variant:"subtitle1",children:["Bank:\xa0",(0,k.jsx)("strong",{children:le.bankName})]})]}),ee&&(0,k.jsx)(k.Fragment,{})]}),!a&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Re.A,{}),(0,k.jsxs)(je.A,{sx:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Dont find the beneficiary?"}),(0,k.jsx)(Se.A,{variant:"text",color:be?"error":"success",onClick:()=>we(!be),children:be?"Close":"Add new"})]}),be&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(Rt.A,{value:de,onChange:e=>ue(e.target.value),fullWidth:!0,label:"Bank Name",variant:"outlined",margin:"normal"})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(Rt.A,{value:xe,onChange:e=>he(e.target.value),fullWidth:!0,label:"Account Number",variant:"outlined",margin:"normal"})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,k.jsx)(Rt.A,{value:me,onChange:e=>pe(e.target.value),fullWidth:!0,label:"Holder Name",variant:"outlined",margin:"normal"})})]}),(0,k.jsx)(Se.A,{onClick:async()=>{try{Ne(!0);const t={bankName:de,accountName:me,accountNumber:xe,userId:l._id},n=await(e=t,p(nn,e));201===n.status&&(ne.oR.success("Saved account"),ce({bankName:n.data.bankName,accountNumber:n.data.accountNumber,accountName:n.data.accountName}))}catch(G){console.error("Error adding new account:",G.message)}finally{Ne(!1)}var e},variant:"outlined",color:"success",size:"medium",disabled:ke,children:ke?"Saving...":"Save"})]})]})]})]}),(0,k.jsxs)(Wt.A,{children:[1===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{onClick:Me,color:"error",children:"Cancel"}),(0,k.jsx)(Se.A,{onClick:()=>{if(0===T.length)return alert("Please save at least one item");d(c+1)},color:"info",variant:"contained",children:"Next"})]}),2===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{onClick:Me,color:"error",children:"Cancel"}),(0,k.jsx)(Se.A,{onClick:()=>{d(c-1)},color:"warning",variant:"contained",children:"Back"}),i?(0,k.jsx)(Se.A,{disabled:E,color:"info",variant:"contained",onClick:e=>(async e=>{e.preventDefault();try{P(!0);const e=K.find((e=>e.name===ee)),t=r.invoices.map((e=>e.name)),s=Z.filter((e=>!t.includes(e.name))),i={userId:l._id,type:A||r.type,title:y||r.title,invoices:[...r.invoices,...s],items:T||r.itemsArray,currency:b||r.currency,amountInWords:"",total:U?Number(U):Number(r.totalItemsAmount)||Number(r.total),accountName:null!==le&&void 0!==le&&le.accountName?le.accountName:me||r.accountName||"Nil",accountNumber:null!==le&&void 0!==le&&le.accountNumber?le.accountNumber:xe||r.accountNumber||"Nil",bankName:null!==le&&void 0!==le&&le.bankName?le.bankName:de||r.bankName||"Nil",attentionTo:null!==e&&void 0!==e&&e.email?e.email:r.attentionTo,projectChargedTo:Ie,date:re()};if(!i.type)return void ne.oR.warning("Type is missing");if(!i.title)return void ne.oR.warning("Title is missing");if(!i.items||i.items.length<1)return void ne.oR.warning("No items added");if(!i.attentionTo)return void ne.oR.warning("Attention to is missing");if(!Fe)return void ne.oR.warning("Please select a project");const a=await un(r._id,i);200===a.status&&(ne.oR.success("Request updated successfully"),o(a.data),d(1),n(),Le())}catch(G){console.log("Failed to save changes",G.message)}finally{P(!1)}})(e),children:E?"Saving...":"Submit Changes"}):a?(0,k.jsx)(Se.A,{onClick:e=>qe(e),color:"success",variant:"contained",disabled:E,children:E?"Submitting...":"Submit Request"}):(0,k.jsx)(Se.A,{onClick:e=>Pe(e),color:"success",variant:"contained",disabled:R,children:R?"Submitting...":"Submit Request"})]})]})]})};var Cs=n(4211),Ss=n.n(Cs),ks=n(6947),Ns=n(3845),Ls=n(2050),Fs=n(8082),Rs=n(3480),Is=n(3736),Es=n(4228),Ps=n(6698),qs=n(3851),Ms=n(7438);const zs=function(e){let{open:t,onClose:n,reqId:i}=e;const[a,r]=(0,s.useState)([]),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(!1),[u,x]=(0,s.useState)({}),[h,m]=(0,s.useState)(!0),{user:p}=Ge(),g=(null===p||void 0===p?void 0:p._id)||"",j=(0,s.useRef)(null);return(0,s.useEffect)((()=>{(async()=>{try{if(i){m(!0);const e=await lt(i);r(e.data)}}catch(G){ne.oR.error(G.message)}finally{m(!1)}})()}),[i,m]),(0,s.useEffect)((()=>{(async()=>{if(g){const e={};for(const t of a)if(!e[t.user_id]){const n=await b(t.user_id);e[t.user_id]=n}x(e)}})()}),[a,g]),(0,s.useEffect)((()=>{t&&j.current&&!c&&j.current.scrollIntoView({behavior:"smooth"})}),[t,a,c]),(0,k.jsx)(It.A,{open:t,onClose:n,"aria-labelledby":"chat-modal-title","aria-describedby":"chat-modal-description",children:(0,k.jsxs)(je.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"rgba(255, 255, 255, 0.9)",boxShadow:24,p:2,borderRadius:"10px",width:"80%",maxWidth:"500px",fontSize:"16px","@media (max-width: 600px)":{width:"90%",maxWidth:"100%",fontSize:"14px"}},children:[(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,k.jsx)(ve.A,{variant:"h5",className:"text-item-header",children:"Messages"}),(0,k.jsx)(Se.A,{onClick:n,color:"error",children:(0,k.jsx)(As.A,{})})]}),(0,k.jsx)(ms.A,{sx:{overflowY:"auto",maxHeight:"200px","@media (max-width: 600px)":{maxHeight:"150px"}},children:h?(0,k.jsx)(ve.A,{variant:"subtitle1",children:"Loading..."}):0===a.length?(0,k.jsx)(ve.A,{variant:"subtitle1",children:"No Messages"}):a&&a.map(((e,t)=>{const n=e.user_id===g,s=n?{}:u[e.user_id],i=t===a.length-1?j:null;return(0,k.jsxs)(at.Ay,{ref:i?j:null,alignItems:"flex-start",sx:{backgroundColor:t%2===0?"#F2F2F2":"#FFFFFF"},children:[(0,k.jsx)(qs.A,{sx:{width:32,height:32},children:(0,k.jsx)(et.A,{alt:n?null===p||void 0===p?void 0:p.name:(null===s||void 0===s?void 0:s.data.name)||"",src:n?null===p||void 0===p?void 0:p.photoUrl:(null===s||void 0===s?void 0:s.data.photoUrl)||""})}),(0,k.jsx)(rt.A,{primary:n?"You":(null===s||void 0===s?void 0:s.data.name)||"...",secondary:e.message})]},t)}))}),(0,k.jsxs)(je.A,{sx:{display:"flex",alignItems:"center",mt:3},children:[(0,k.jsx)(Rt.A,{id:"outlined-basic",label:"New Message",variant:"outlined",size:"small",fullWidth:!0,sx:{mr:1},value:o,onChange:e=>l(e.target.value),disabled:c}),(0,k.jsx)(Se.A,{className:"btn-type-info btn-md",onClick:async()=>{try{d(!0),await dt(i,p._id,o);const e=await lt(i);r(e.data)}catch(G){ne.oR.error(G.message)}finally{d(!1),l("")}},children:c?"...":(0,k.jsx)(Ms.A,{className:"h-6 w-6 text-gray-500"})})]})]})})};var Bs=n(7532),Hs=n(32),Ds=n.n(Hs),_s=n(1559);const Ts="account-codes";const Ws=function(e){let{open:t,onClose:n,title:i,content:a,onConfirm:r,onCancel:o}=e;const[l,c]=s.useState(!1);return(0,k.jsx)(Ce.A,{open:t,onClose:()=>n(),maxWidth:"sm",children:(0,k.jsxs)(je.A,{sx:{width:400,bgcolor:"background.paper",boxShadow:24,p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,k.jsx)(ke.A,{sx:{fontSize:40,color:"primary.main"}}),(0,k.jsx)(ve.A,{variant:"h6",align:"center",children:i}),(0,k.jsx)(ve.A,{variant:"body",align:"center",children:a}),(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:[(0,k.jsx)(Se.A,{variant:"contained",color:"primary",onClick:()=>(async()=>{c(!0),await r(),c(!1)})(),disabled:l,sx:{mx:1},children:l?"Loading...":"Yes"}),(0,k.jsx)(Se.A,{variant:"contained",color:"secondary",onClick:()=>n(),sx:{mx:1},children:"No"})]})]})})},Us=e=>{var t,n;let{isOpen:i,onClose:a,requisitionId:r,triggerUpdateRequisition:o,isRetirement:l,updateTableData:c}=e;const{user:d}=Ge(),[u,x]=(0,s.useState)(!1),[h,m]=(0,s.useState)(Mn),[p,A]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1),[f,b]=(0,s.useState)([]),[w,C]=(0,s.useState)(null),S=(0,s.useCallback)((async()=>{const e=await g(Ts);b(e.data)}),[]),N=(0,s.useCallback)((()=>{c()}),[]);(0,s.useEffect)((()=>{S(),N()}),[i,r,S,N]);(0,s.useEffect)((()=>{i&&r&&(async()=>{x(!0);try{const e=await on(r);m(e.data)}catch(G){console.error("Error fetching requisition details:",G)}finally{x(!1)}})()}),[i,r]);const L=(e,t)=>(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:e}),(0,k.jsx)(Jt.A,{children:t.name})]},e),F=e=>{const t=e.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif"].includes(t)},R={name:null===d||void 0===d?void 0:d.name,email:null===d||void 0===d?void 0:d.email,signatureUrl:null===d||void 0===d?void 0:d.signatureUrl},I=()=>ne.oR.info("Requisition Updated"),E=async()=>{await mn(r),a()},P=async()=>{await(e=>j("requisitions/cancel/".concat(e)))(r),a()},[q,M]=(0,s.useState)(!1),[z,B]=(0,s.useState)(""),[H,D]=(0,s.useState)(""),_=h&&(null===h||void 0===h?void 0:h.title)&&(null===h||void 0===h?void 0:h.status),[T,V]=(0,s.useState)(!1);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(It.A,{open:i,onClose:a,children:(0,k.jsxs)(an.A,{style:{maxWidth:"70%",margin:"auto",marginTop:"50px",padding:"20px",overflowY:"auto",maxHeight:"90vh"},children:[u&&(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"50px"},children:"Fetching..."}),!_&&!u&&(0,k.jsx)(ve.A,{variant:"body1",align:"center",style:{marginTop:"50px"},children:"No requisition found with the searched ID."}),_&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(je.A,{sx:{display:"flex",justifyContent:"space-between "},children:[(0,k.jsx)(ve.A,{variant:"h6",children:"Requisition Details"}),(0,k.jsxs)(je.A,{children:[(0,k.jsx)(Se.A,{size:"small",variant:"contained",color:"info",onClick:()=>y(!0),children:"Chat"}),(0,k.jsx)($e.A,{color:"error",onClick:a,sx:{ml:2},children:(0,k.jsx)(_e.A,{fontSize:"medium",children:(0,k.jsx)(As.A,{})})})]})]}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:3,padding:2,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:3,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(0,k.jsx)("strong",{children:"Type"})}),(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:h.type})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:3,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(0,k.jsx)("strong",{children:"Raised By"})}),(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:h.user.name})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:3,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(0,k.jsx)("strong",{children:"Date"})}),(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(Y=h.date,ie()(Y).format("DD MMM YYYY"))})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:3,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(0,k.jsx)("strong",{children:"Serial Number"})}),(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:h.serialNumber||"N/A"})]}),"approved"===h.status&&(0,k.jsxs)(Et.Ay,{item:!0,xs:3,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:(0,k.jsx)("strong",{children:"Approval Number"})}),(0,k.jsx)(ve.A,{variant:"subtitle2",align:"center",children:h.approvalNumber||"N/A"})]})]}),(0,k.jsx)(Re.A,{sx:{mt:1,borderColor:"neutral.300"}}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:3,padding:2,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:12,sx:{mb:2},children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Description"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.title})]}),(0,k.jsx)(Et.Ay,{item:!0,xs:4,children:(0,k.jsx)(Gt.A,{children:(0,k.jsx)(Yt.A,{children:(0,k.jsxs)($t.A,{children:[(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{component:"th",scope:"row",children:"Status:"}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(ve.A,{variant:"body2",sx:{color:e=>Rn[h.status]&&e.palette.text.primary,backgroundColor:e=>Rn[h.status]&&e.palette[Rn[h.status]].light,display:"inline",marginRight:"8px",padding:"4px 8px",borderRadius:"4px"},children:ce(h.status)})})]}),(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{component:"th",scope:"row",children:"Retirement:"}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(ve.A,{variant:"body2",sx:{color:e=>Rn[h.retiredStatus||"cancelled"]&&e.palette.text.primary,backgroundColor:e=>Rn[h.retiredStatus||"cancelled"]&&e.palette[Rn[h.retiredStatus||"cancelled"]].light,display:"inline",marginRight:"8px",padding:"4px 8px",borderRadius:"4px"},children:ce(h.retiredStatus||"controlled")})})]})]})})})}),(0,k.jsxs)(Et.Ay,{item:!0,xs:8,sx:{boxShadow:"0 0 2px grey"},children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Status History"}),(0,k.jsx)(Gt.A,{component:an.A,children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:"Status"}),(0,k.jsx)(Jt.A,{children:"By"})]})}),(0,k.jsxs)($t.A,{children:[h.holderCheck&&L("Checked",h.holderCheck),h.checkedBy&&L("Finance Check",h.checkedBy),h.reviewedBy&&L("Finance Review",h.reviewedBy),h.approvedBy&&L("Approved",h.approvedBy)]})]})})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,sx:{mt:2},children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Items List"}),(0,k.jsx)(Gt.A,{component:an.A,sx:{mt:1},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:"Title"}),(0,k.jsx)(Jt.A,{children:"Amount"}),(0,k.jsx)(Jt.A,{children:"Budget Code"})]})}),(0,k.jsx)($t.A,{children:h.items.map(((e,t)=>(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:e.title}),(0,k.jsx)(Jt.A,{children:ue(e.amount)}),(0,k.jsx)(Jt.A,{children:e.code})]},t)))})]})}),(0,k.jsxs)(je.A,{sx:{mt:2},children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Total"}),(0,k.jsx)(ve.A,{variant:"body2",children:(0,k.jsx)("strong",{children:Ds().formatMoney(h.total,de[h.currency])})})]})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Invoices"}),(0,k.jsx)(Et.Ay,{container:!0,spacing:2,children:(h.invoices&&h.invoices.length>0?h.invoices:h.receipts||[]).map(((e,t)=>(0,k.jsx)(Et.Ay,{item:!0,children:F(e.url)?(0,k.jsx)("img",{src:e.url,alt:e.name,style:{width:"100px",height:"100px",cursor:"pointer"},onClick:()=>window.open(e.url,"_blank")}):(0,k.jsxs)("div",{style:{width:"fit-content",height:"fit-content",padding:"5px",backgroundColor:"#E5E7EB",textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"5px",transition:"background-color 0.3s ease"},onClick:()=>window.open(e.url,"_blank"),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#D2D6DB",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#E5E7EB",children:[(0,k.jsx)(_s.A,{style:{height:24,width:24}}),(0,k.jsx)(ve.A,{variant:"caption",children:e.name})]})},t)))})]})]}),(0,k.jsx)(Re.A,{sx:{my:1,borderColor:"neutral.300"}}),(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,padding:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsx)(ve.A,{variant:"subtitle1",children:"Beneficiary Details:"})}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Bank"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.bankName})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Account Holder"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.accountName})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Account Number"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.accountNumber})]}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsx)(Re.A,{sx:{borderColor:"neutral.300"}})})]}),(0,k.jsxs)(k.Fragment,{children:[h.projectChargedTo&&(0,k.jsxs)(Et.Ay,{container:!0,space:2,padding:2,children:[(0,k.jsx)(ve.A,{sx:{my:3},children:"Project Account Section"}),h.projectChargedTo&&(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsxs)(ve.A,{variant:"subtitle1",children:["Project Charged to:"," ",(0,k.jsx)("strong",{children:(null===(t=h.projectChargedTo)||void 0===t?void 0:t.projectName)||""})]})}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Source Bank"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.projectChargedTo.account.bankName})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Holder"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.projectChargedTo.account.accountName})]}),(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"subtitle2",children:"Account Number"}),(0,k.jsx)(ve.A,{variant:"body1",children:h.projectChargedTo.account.accountNumber})]})]}),(0,k.jsx)(Re.A,{}),("holderCheck"===h.status||"holderChecked"===h.status)&&"finance"===d.accessLevel&&(0,k.jsx)(Et.Ay,{container:!0,spacing:3,sx:{pl:2},children:(0,k.jsxs)(Et.Ay,{item:!0,xs:4,children:[(0,k.jsx)(ve.A,{variant:"body1",sx:{my:1},children:"Select Account Code"}),(0,k.jsx)(Tt.A,{fullWidth:!0,options:f,getOptionLabel:e=>"".concat(null===e||void 0===e?void 0:e.value,"-").concat(null===e||void 0===e?void 0:e.description)||"",value:w,onChange:(e,t)=>{C(t)},renderInput:e=>(0,k.jsx)(Rt.A,{...e,label:"Account Codes",fullWidth:!0})})]})}),(0,k.jsxs)(ft.A,{children:["pending"===h.status&&"budgetHolder"===d.accessLevel&&h.attentionTo.includes(null===d||void 0===d?void 0:d.email)?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{variant:"contained",color:"secondary",size:"small",onClick:async()=>{A(!0),await((e,t)=>j("requisitions/budgetHolderCheck/".concat(e),t))(r,R),I(),a(),A(!1)},disabled:p,children:p?"Loading...":"Check as Budget Holder"}),(0,k.jsx)(Se.A,{size:"small",sx:{ml:2},variant:"outlined",color:"error",onClick:E,disabled:p,children:p?"Loading...":"Send Back"})]}):"pending"===h.status?(0,k.jsx)(ve.A,{style:{color:O.main},children:"Request Awaiting Budget Holder Check"}):"holderCheck"!==h.status&&"sentBack"!==h.status&&"holderChecked"!==h.status||"finance"!==d.accessLevel?"holderCheck"===h.status||"holderChecked"===h.status?(0,k.jsx)(ve.A,{sx:{color:W.main},children:"Request Awaiting Finance Check"}):"checked"===h.status&&"financeReviewer"===d.accessLevel?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{onClick:async()=>{await((e,t)=>j("requisitions/financeReview/".concat(e),t))(r,R),I(),a(),A(!1)},variant:"contained",color:"info",disabled:p,size:"small",children:p?"Loading...":"Finance Review"}),(0,k.jsx)(Se.A,{size:"small",onClick:()=>a,children:"Cancel"})]}):"checked"===h.status?(0,k.jsx)(ve.A,{sx:{color:U.main},children:"Request Awaiting Finance Review"}):"reviewed"===h.status&&"superUser"===d.accessLevel?(0,k.jsx)(Se.A,{size:"small",onClick:async()=>{await((e,t)=>j("requisitions/approve/".concat(e),t))(r,R),I(),a(),A(!1)},variant:"contained",color:"success",disabled:p,children:p?"Loading...":"Approve"}):"reviewed"===h.status?(0,k.jsx)(ve.A,{sx:{color:U.ppdc},children:"Request Awaiting Approval"}):"approved"!==h.status||"finance"!==(null===d||void 0===d?void 0:d.accessLevel)&&"financeReviewer"!==(null===d||void 0===d?void 0:d.accessLevel)?null:(0,k.jsx)(k.Fragment,{children:l?(0,k.jsx)(Se.A,{size:"small",onClick:()=>V(!0),startIcon:(0,k.jsx)(Bs.A,{}),children:"Mark as Retired"}):(0,k.jsx)(Se.A,{size:"small",onClick:P,children:"Cancel Payment"})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Se.A,{variant:"contained",color:"primary",disabled:p,size:"small",onClick:async()=>{var e,t,n;if(!w)return ne.oR.warning("Please select account code!");const s={code:"".concat(null!==(e=null===w||void 0===w?void 0:w._id)&&void 0!==e?e:"","-").concat(null!==(t=null===w||void 0===w?void 0:w.value)&&void 0!==t?t:"","-").concat(null!==(n=null===w||void 0===w?void 0:w.description)&&void 0!==n?n:"")};await un(r,s),await((e,t)=>j("requisitions/financeCheck/".concat(e),t))(r,R),I(),a(),A(!1)},children:p?"Loading...":"Finance Check"}),(0,k.jsx)(Se.A,{size:"small",onClick:E,children:"Send Back"})]}),"approved"===h.status&&(0,k.jsx)(ve.A,{sx:{mt:2,color:U.ppdc,textAlign:"center"},children:(0,k.jsx)("strong",{children:"This request is Approved!"})}),(0,k.jsx)(Re.A,{sx:{my:1}}),(0,k.jsxs)(k.Fragment,{children:[q&&(0,k.jsxs)(Et.Ay,{container:!0,spacing:1,alignItems:"center",children:[(0,k.jsx)(Et.Ay,{item:!0,xs:8,children:(0,k.jsx)(Rt.A,{label:"Enter Reason",variant:"outlined",value:z,onChange:e=>B(e.target.value),fullWidth:!0})}),(0,k.jsx)(Et.Ay,{item:!0,xs:2,children:(0,k.jsx)(Se.A,{size:"small",variant:"contained",color:"info",onClick:async()=>{await dt(r,d._id,z),"Cancel"===H?P():"Send Back"===H&&E(),M(!1),B("")},children:"Submit"})}),(0,k.jsx)(Et.Ay,{item:!0,xs:2,children:(0,k.jsx)(Se.A,{size:"small",variant:"contained",color:"secondary",onClick:()=>{M(!1),B("")},children:"Abort"})})]}),!q&&(0,k.jsx)(k.Fragment,{children:"approved"===h.status&&"financeReviewer"===d.accessLevel&&(0,k.jsx)(Se.A,{variant:"contained",size:"small",color:"error",onClick:()=>{return e="Cancel",M(!0),void D(e);var e},children:"Cancel"})})]}),"approved"!==h.status&&(null===h||void 0===h||null===(n=h.user)||void 0===n?void 0:n.name)===(null===d||void 0===d?void 0:d.name)&&(0,k.jsx)(Se.A,{sx:{ml:2},variant:"outlined",color:"error",size:"small",onClick:async()=>{await xn(r),I(),a()},children:"Delete Request"})]})]})]})]})}),r&&(0,k.jsx)(s.Suspense,{fallback:null,children:(0,k.jsx)(zs,{open:v,onClose:()=>y(!1),reqId:r})}),(0,k.jsx)(s.Suspense,{fallback:null,children:(0,k.jsx)(Ws,{open:T,onClose:()=>V(!1),title:"Mark Requisition as Retired",content:"Are you sure you want to mark this requisition as retired?",onConfirm:async()=>{try{200===(await hn(r)).status&&(N(),ne.oR.success("Requisition marked as retired."),V(!1))}catch(G){console.log("Error marking requisition as retired:",G.message),ne.oR.error("An error occurred. Please try again.")}}})})]});var Y},Os=async e=>{try{if(!e.approvedBy&&!e.checkedBy)return ne.oR.error("Requisition must be checked and approved");const o=await le("/assets/blankDoc.png");let l,c,d,u=jn(e.date),x=jn((null===e||void 0===e?void 0:e.hoderCheckDate)||(null===e||void 0===e?void 0:e.holderCheckDate)),h=e.reviewedDate?jn(e.reviewedDate):e.checkedDate?jn(e.checkedDate):null,m=jn(e.approvedDate),p=(r=e.date,ie()(r).format("DD MMM YYYY"));const g="Fund Req"===e.type?"FUND REQUISITON":"PETTY CASH";let j=e.user&&e.user.signatureUrl?await le(e.user.signatureUrl):o,A=await le("/assets/logos/ppdc-new-logo.png"),v=e.approvedBy&&e.approvedBy.signatureUrl?await le(e.approvedBy.signatureUrl):o;if("Fund Req"===e.type){var t,n,s,i,a;d=(e=>ie()(e).format("DD-MM-YY"))(e.date)+(null===e||void 0===e?void 0:e.projectName)?e.projectName.substr(0,3).toUpperCase():(null===(t=e.projectChargedTo)||void 0===t?void 0:t.projectName.substr(0,3).toUpperCase())||"";let r=e.holderCheck&&null!==(n=e.holderCheck)&&void 0!==n&&n.signatureUrl?await le(e.holderCheck.signatureUrl):o,p=e.reviewedBy&&e.reviewedBy.signatureUrl?await le(e.reviewedBy.signatureUrl):e.checkedBy&&e.checkedBy.signatureUrl?await le(e.checkedBy.signatureUrl):o;l=[[{text:"Raised By",style:"labelStyle"},{text:e.user.name,style:"fieldStyle"},{text:u,style:"fieldStyle"},{image:j,width:30,height:30}],[{text:"Budget Holder",style:"labelStyle"},{text:(null===(s=e.holderCheck)||void 0===s?void 0:s.name)||" ",style:"fieldStyle"},{text:x||" ",style:"fieldStyle"},{image:r||" ",width:30,height:30}],[{text:"Reviewed By",style:"labelStyle"},{text:(null===e||void 0===e||null===(i=e.reviewedBy)||void 0===i?void 0:i.name)||(null===e||void 0===e||null===(a=e.checkedBy)||void 0===a?void 0:a.name)||" ",style:"fieldStyle"},{text:h||" ",style:"fieldStyle"},{image:p,width:30,height:30}],[{text:"Approved By",style:"labelStyle"},{text:e.approvedBy.name,style:"fieldStyle"},{text:m,style:"fieldStyle"},{image:v,width:30,height:30}]],c=[[{text:"Project Name",style:"labelStyle"},{text:null!==e&&void 0!==e&&e.projectName?e.projectName:"n/a",style:"fieldStyle"}],[{text:"Source Bank Name",style:"labelStyle"},{text:e.sourceBankName,style:"fieldStyle"}],[{text:"Source Account Number",style:"labelStyle"},{text:e.sourceAccountNumber,style:"fieldStyle"}]]}else l=[[{text:"Raised By",style:"labelStyle"},{text:e.user.name,style:"fieldStyle"},{text:u,style:"fieldStyle"},{image:j,width:30,height:30}],[{text:"Approved By",style:"labelStyle"},{text:e.approvedBy.name,style:"fieldStyle"},{text:m,style:"fieldStyle"},{image:v,width:30,height:30}]],c=[],d="Petty Cash";let y=[[{text:"Item Description",style:"labelStyle"},{text:"Budget Line",style:"labelStyle"},{text:"Amount",style:"labelStyle"}]];return e.items.forEach((t=>{let n=[{text:t.title,style:"tableBodyText"},{text:t.code||"",style:"tableBodyText"},{text:Hs.formatMoney(t.amount,de[e.currency]),style:"tableBodyText"}];y.push(n)})),{header:{columns:[{image:A,width:100,height:30},{text:"".concat(d,"/").concat(e.approvalNumber),margin:[130,0,0,0],style:"reference"}],margin:[20,10]},footer:{text:"Gwapp 3.0",style:"footerStyle"},content:[{text:g,style:"header"},{text:p,style:"dateStyle"},{text:"General Info",style:"subheader"},{text:"Name",style:"labelStyle"},{text:e.user.name,style:"fieldStyle"},{text:"Purpose of Payment",style:"labelStyle"},{text:e.title,style:"fieldStyle"},{text:"Project Charged To",style:"labelStyle"},{text:null!==e&&void 0!==e&&e.projectName?e.projectName:"n/a",style:"fieldStyle"},{text:"Bank Details",style:"subheader"},{columns:[[{text:"Name of Beneficiary",style:"labelStyle"},{text:e.accountName,style:"fieldStyle"}],[{text:"Beneficiary Bank Name",style:"labelStyle"},{text:e.bankName,style:"fieldStyle"}],[{text:"Beneficiary Account Number",style:"labelStyle"},{text:e.accountNumber,style:"fieldStyle"}]]},{columns:c},{text:"Items",style:"subheader"},{style:"tableExample",table:{headerRows:1,widths:["*","auto",50],body:y},layout:{fillColor:function(e,t,n){return e%2===0?"#CCCCCC":null}}},{columns:[[{text:"Total",style:"labelStyle"},{text:Hs.formatMoney(e.total,de[e.currency]),style:"fieldStyle"}],[{text:"Amount In Words",style:"labelStyle"},{text:e.amountInWords,style:"fieldStyle"}]]},{columns:l}],styles:{reference:{color:"#006C37",alignment:"right"},header:{fontSize:24,alignment:"center",margin:[0,10]},subheader:{fontSize:16,bold:!0,color:"#7cda24",margin:[0,15]},labelStyle:{bold:!0,fontSize:10,margin:[0,10,0,3]},fieldStyle:{fontSize:12,margin:[0,3,0,5],color:"#6C737F"},tableExample:{margin:[0,10]},tableBodyText:{fontSize:10,italics:!0},dateStyle:{alignment:"center",fontSize:"10",bold:!0,color:"#7cda24"},footerStyle:{alignment:"center",fontSize:8,margin:[0,0],italics:!0,color:"#006c37"}}}}catch(G){console.log("Failed to Print",G),ne.oR.error("Failed to Print\n",null===G||void 0===G?void 0:G.message)}var r};Ss().vfs=ks.b.vfs;const Vs=e=>{let{requisitions:t,loading:n,totalCount:i,setRequisitions:a,onEditRequisition:r,updateTableData:o,reqId:l,action:c,page:d,limit:u,onPageChange:x,onLimitChange:h}=e;const{user:m}=Ge(),[p,g]=(0,s.useState)(!1),[j,A]=(0,s.useState)(""),[v,y]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),[w,C]=(0,s.useState)(null),[S,N]=(0,s.useState)(!1),[L,F]=(0,s.useState)(""),R=()=>{y(!1),A(""),o()};(0,s.useEffect)((()=>{v||a((e=>[...e]))}),[v,a]);const I=(0,s.useCallback)((e=>{A(e),y(!0)}),[]);(0,s.useEffect)((()=>{l&&"openModal"===c&&I(l)}),[l,c,I]);const E=e=>{r(e),o()},[P,q]=(0,s.useState)(!1),[M,z]=(0,s.useState)({}),B=async e=>{try{z((t=>({...t,[e]:!0})));const t=await on(e),n=await t.data,s=await Os(n);Ss().createPdf(s).open()}catch(G){console.log(G),ne.oR.error(G.message)}finally{z((t=>({...t,[e]:!1})))}};return(0,k.jsxs)(k.Fragment,{children:[n?(0,k.jsxs)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,k.jsx)(wn.A,{color:"success"}),(0,k.jsx)(je.A,{sx:{mt:2},children:"Relax while we load your data..."})]}):(0,k.jsxs)(k.Fragment,{children:[(!t||0===(null===t||void 0===t?void 0:t.length))&&(0,k.jsx)(ve.A,{sx:{mt:2},children:"No requisitions found."}),t&&(null===t||void 0===t?void 0:t.length)>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gt.A,{sx:{mt:2},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"SN"}),(0,k.jsx)(Jt.A,{sx:{width:"35%"},children:"Title"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Raised By"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Amount"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Date"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Status"}),(0,k.jsx)(Jt.A,{sx:{width:"15%","@media (max-width: 600px)":{display:"none"}},children:"Actions"})]})}),(0,k.jsx)($t.A,{children:t&&(null===t||void 0===t?void 0:t.map((e=>{var t,n,s,i,a,r,l;return(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:null!==e&&void 0!==e&&e.serialNumber?null===e||void 0===e?void 0:e.serialNumber:"N/A"}),(0,k.jsx)(Jt.A,{sx:{cursor:"pointer","&:hover":{backgroundColor:"#F3F4F6",boxShadow:"inset 0 0 5px rgba(0,0,0,0.1)"},paddingTop:"2rem"},onClick:()=>I(null===e||void 0===e?void 0:e._id),children:(0,k.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,k.jsx)(Ns.A,{label:null===e||void 0===e?void 0:e.type,style:{position:"absolute",top:"-20px",left:"0",fontSize:"10px",height:"18px",lineHeight:"18px"}}),(0,k.jsx)(Ke.A,{placement:"left-start",title:null===e||void 0===e?void 0:e.title,children:(0,k.jsx)("span",{children:Fn(null===e||void 0===e?void 0:e.title,50)})})]})}),(0,k.jsx)(Jt.A,{children:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.name}),(0,k.jsxs)(Jt.A,{children:[pn(null===e||void 0===e?void 0:e.currency),gn(Number(null===e||void 0===e?void 0:e.total))]}),(0,k.jsx)(Jt.A,{children:ae(null===e||void 0===e?void 0:e.date)}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Ln,{color:Rn[(null===e||void 0===e?void 0:e.status)||"pending"],children:"checked"===(null===e||void 0===e?void 0:e.status)?"financeCheck":null===e||void 0===e?void 0:e.status})}),(0,k.jsxs)(Jt.A,{className:"animated-border",children:[M[e._id]&&(0,k.jsxs)("sup",{children:[(0,k.jsx)(wn.A,{size:10}),(0,k.jsx)("small",{children:"\xa0Loading.."})]}),(0,k.jsx)(hs.A,{sx:{"& .MuiOutlinedInput-root":{border:"none"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none"},"& .MuiFilledInput-underline:after":{border:"none"},"& .MuiFilledInput-underline:before":{border:"none"},"&:hover .MuiFilledInput-underline:before":{border:"none"},"& .MuiFilledInput-underline.Mui-focused:before":{border:"none"}},IconComponent:Fs.A,renderValue:e=>(0,k.jsxs)("span",{children:[(0,k.jsx)(Fs.A,{}),e]}),children:(0,k.jsxs)(xt.A,{sx:{border:"none"},children:[(0,k.jsx)(Ke.A,{placement:"left-start",title:"View details",children:(0,k.jsxs)(ht.A,{onClick:()=>I(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(js.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"View Details"})]})}),(0,k.jsx)(Ke.A,{placement:"left-start",title:"Messages",children:(0,k.jsxs)(ht.A,{onClick:()=>(e=>{A(e),g(!0),o()})(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(Rs.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Messages"})]})}),"reviewed"!==(null===e||void 0===e?void 0:e.status)&&"approved"!==(null===e||void 0===e?void 0:e.status)&&"user"!==(null===m||void 0===m?void 0:m.accessLevel)&&"userManager"!==(null===m||void 0===m?void 0:m.accessLevel)&&null!==e&&void 0!==e&&e.attentionTo.includes(null===m||void 0===m?void 0:m.email)?(0,k.jsx)(Ke.A,{placement:"left-start",title:"Send Back",children:(0,k.jsxs)(ht.A,{onClick:t=>(async e=>{await mn(e),R(),o()})(t,null===e||void 0===e||e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(Is.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Send Back"})]})}):null,"reviewed"===(null===e||void 0===e?void 0:e.status)||"approved"===(null===e||void 0===e?void 0:e.status)||"deleted"===(null===e||void 0===e?void 0:e.status)||"retired"===(null===e||void 0===e?void 0:e.retiredStatus)||(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.name)!==(null===m||void 0===m?void 0:m.name)&&(null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.email)!==(null===m||void 0===m?void 0:m.email)?null:(0,k.jsx)(Ke.A,{placement:"left-start",title:"Edit",children:(0,k.jsxs)(ht.A,{value:"edit",onClick:()=>(async e=>{try{const t=await on(e);C(t.data),N(!0),b(!0),o()}catch(G){console.log("Error getting single requisition:",G.message)}})(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(Es.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Edit"})]})}),"approved"!==(null===e||void 0===e?void 0:e.status)||(null===e||void 0===e||null===(i=e.user)||void 0===i?void 0:i.name)!==(null===m||void 0===m?void 0:m.name)&&(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.email)!==(null===m||void 0===m?void 0:m.email)&&!["tech"].includes(null===m||void 0===m?void 0:m.accessLevel)?null:(0,k.jsx)(Ke.A,{placement:"left-start",title:"Print",children:(0,k.jsxs)(ht.A,{value:"print",onClick:()=>B(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:M[null===e||void 0===e?void 0:e._id]?(0,k.jsx)(wn.A,{size:20}):(0,k.jsx)(Ps.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Print"})]})}),"approved"!==(null===e||void 0===e?void 0:e.status)&&"reviewed"!==(null===e||void 0===e?void 0:e.status)&&"checked"!==(null===e||void 0===e?void 0:e.status)||!["finance","financeReviewer"].includes(null===m||void 0===m?void 0:m.accessLevel)?null:(0,k.jsx)(Ke.A,{placement:"left-start",title:"Print",children:(0,k.jsxs)(ht.A,{value:"print",onClick:()=>B(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:M[null===e||void 0===e?void 0:e._id]?(0,k.jsx)(wn.A,{size:20}):(0,k.jsx)(Ps.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Print"})]})}),"approved"===(null===e||void 0===e?void 0:e.status)||"reviewed"===(null===e||void 0===e?void 0:e.status)||"deleted"===(null===e||void 0===e?void 0:e.status)||"retired"===(null===e||void 0===e?void 0:e.retiredStatus)||(null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.name)!==(null===m||void 0===m?void 0:m.name)&&(null===e||void 0===e||null===(l=e.user)||void 0===l?void 0:l.email)!==(null===m||void 0===m?void 0:m.email)?null:(0,k.jsx)(Ke.A,{placement:"top-start",title:"Delete",children:(0,k.jsxs)(ht.A,{value:"delete",onClick:()=>{q(!0),F(null===e||void 0===e?void 0:e._id)},children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(Oe.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Delete"})]})})]})})]})]},null===e||void 0===e?void 0:e._id)})))})]})}),(0,k.jsx)(Kn.A,{rowsPerPageOptions:[5,10,25],component:"div",count:Number(i),rowsPerPage:u,page:d,onPageChange:x,onRowsPerPageChange:h})]})]}),(0,k.jsx)(zs,{open:p,onClose:()=>{A(""),g(!1),o()},reqId:j}),(0,k.jsx)(Ws,{open:P,onClose:()=>q(!1),title:"Delete Requisition",content:"Are you sure you want to delete this requisition?",onConfirm:async()=>{try{await xn(L),o(),q(!1)}catch(G){console.log("Error deleting requisition as retired:",G.message),ne.oR.error("An error occurred. Please try again.")}}}),(0,k.jsx)(Us,{isOpen:v,requisitionId:j,onClose:R,triggerUpdateRequisition:E,updateTableData:o}),(0,k.jsx)(ws,{open:f,retireMode:!1,onClose:()=>{N(!1),b(!1),o()},triggerUpdateRequisition:E,isEditMode:S,requisitionData:w||null})]})};var Gs=n(1144),Ys=n(6708),Zs=n(847),Xs=n(6847);const Js=e=>{let{setFilteredRequisitions:t,filteredPage:n,filteredLimit:i,setFilteredTotalCount:a,setLoading:r}=e;const[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(!1),[u,x]=(0,s.useState)(!1),{user:h}=Ge(),[m,p]=(0,s.useState)({user_email:"",type:"",status:"",startDate:"",endDate:"",retiredStatus:"",serialNumber:""}),j=(0,s.useCallback)((async()=>{r(!0);const{user_email:e,type:s,status:o,startDate:l,endDate:c,retiredStatus:d,serialNumber:u}=m;if(e||s||o||l||c||d||u){const e=await((e,t,n)=>{const s=new URLSearchParams(e).toString(),i="".concat("filter-requisitions","?").concat(s);return g(t&&n?"".concat(i,"&page=").concat(t,"&limit=").concat(n):i)})(m,n,i);t(e.data.requisitions),a(e.data.totalCount),r(!1)}else t([]),r(!1)}),[m,n,i,t,a,r]);(0,s.useEffect)((()=>{(async()=>{const e=await(async()=>{try{return await g("all-users")}catch(G){throw new Error(G.message)}})();e&&e.data&&l(e.data.users)})()}),[]);const A=e=>{const{name:t,value:n}=e.target;p((e=>({...e,[t]:n})))};(0,s.useEffect)((()=>{j()}),[j]);return(0,k.jsxs)(ss.A,{sx:{border:"1px solid ".concat(U.light)},children:[(0,k.jsx)(is.A,{expandIcon:(0,k.jsx)(rs.A,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,k.jsx)(ve.A,{children:"Filter Requisitions"})}),(0,k.jsx)(as.A,{children:(0,k.jsxs)(Et.Ay,{container:!0,spacing:2,children:[(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsxs)(us.A,{fullWidth:!0,children:[(0,k.jsx)(xs.A,{children:"Type"}),(0,k.jsxs)(hs.A,{value:m.type,onChange:e=>p((t=>({...t,type:e.target.value}))),label:"Type",children:[(0,k.jsx)(ht.A,{value:"Fund Req",children:"Fund Requisition"}),(0,k.jsx)(ht.A,{value:"Advance",children:"Advance"}),(0,k.jsx)(ht.A,{value:"Petty Cash",children:"Petty Cash"}),(0,k.jsx)(ht.A,{value:"reimbursement",children:"Reimbursement"})]})]})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsxs)(us.A,{fullWidth:!0,children:[(0,k.jsx)(xs.A,{children:"Status"}),(0,k.jsxs)(hs.A,{value:m.status,onChange:e=>p((t=>({...t,status:e.target.value}))),label:"Status",children:[(0,k.jsx)(ht.A,{value:"pending",children:"Pending"}),(0,k.jsx)(ht.A,{value:"holderCheck",children:"Holder Checked"}),(0,k.jsx)(ht.A,{value:"checked",children:"Finance Checked"}),(0,k.jsx)(ht.A,{value:"reviewed",children:"Reviewed"}),(0,k.jsx)(ht.A,{value:"approved",children:"Approved"})]})]})}),"user"!==h.accessLevel&&"userManager"!==h.accessLevel&&(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsx)(Tt.A,{options:o.map((e=>e.name)),renderInput:e=>(0,k.jsx)(Rt.A,{...e,label:"User",fullWidth:!0,sx:{marginBottom:"1rem"}}),onChange:(e,t)=>{const n=o.find((e=>e.name===t));n&&p((e=>({...e,user_email:n.email})))}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsx)(Rt.A,{fullWidth:!0,type:"date",label:"Start Date",name:"startDate",value:m.startDate,onChange:A,InputLabelProps:{shrink:!0}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsx)(Rt.A,{fullWidth:!0,type:"date",label:"End Date",name:"endDate",value:m.endDate,onChange:A,InputLabelProps:{shrink:!0}})}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:4,children:(0,k.jsx)(Rt.A,{fullWidth:!0,type:"text",label:"Serial Number",name:"serialNumber",value:m.serialNumber,onChange:A,InputLabelProps:{shrink:!0}})}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,md:3,sx:{display:"flex",alignItems:"center"},children:[(0,k.jsxs)(Se.A,{size:"small",color:"info",variant:"contained",onClick:j,children:[(0,k.jsx)(Zs.A,{}),"Search"]}),(0,k.jsxs)(Se.A,{size:"small",sx:{ml:1},color:"warning",variant:"contained",onClick:()=>{p({user_email:"",type:"",status:"",startDate:"",endDate:"",retiredStatus:"",serialNumber:""})},children:[(0,k.jsx)(Xs.A,{}),"Reset"]})]}),(0,k.jsx)(Et.Ay,{item:!0,xs:6,md:9,sx:{display:"flex",justifyContent:"end"},children:(0,k.jsx)(Ke.A,{title:"Download Approved Requests",children:(0,k.jsxs)(Se.A,{size:"small",variant:"outlined",color:"success",onClick:async()=>{try{x(!0);const e={...m},t=Object.keys(e).reduce(((e,t)=>(m[t]&&(e[t]=m[t]),e)),{}),n=await ln(t),s=new Blob([n.data],{type:"text/csv"}),i=window.URL.createObjectURL(s),a=document.createElement("a");a.href=i,a.setAttribute("download","approved_requisitions-".concat(oe,".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a),d(!1),x(!1)}catch(G){ne.oR.error("An error occurred. Please try again."),d(!1),x(!1),console.log(G.message)}finally{d(!1)}},disabled:u||c,sx:{ml:"auto"},children:[u&&(0,k.jsx)(k.Fragment,{children:"fetching.."}),!u&&(0,k.jsx)(k.Fragment,{children:c?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ys.A,{}),"downloading.."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gs.A,{}),"Download"]})})]})})})]})})]})};var $s=n(2180),Ks=n(4642);const Qs=e=>{let{label:t,isActive:n,onClick:s}=e;return(0,k.jsx)(je.A,{sx:{padding:"10px",cursor:"pointer",borderBottom:n?"2px solid blue":"2px solid transparent",color:n?"blue":"black",marginRight:"20px"},onClick:s,children:t})};Ss().vfs=ks.b.vfs;const ei=()=>{Ct();const{user:e}=Ge(),t=(0,ge.zy)(),n=new URLSearchParams(t.search),i=n.get("id"),a=n.get("action"),r=n.get("selectedTab"),[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[u,x]=(0,s.useState)(0),[h,m]=(0,s.useState)(!1),[p,j]=(0,s.useState)(""),[A,v]=(0,s.useState)(!1),[y]=(0,s.useState)(null),[f,b]=(0,s.useState)(!1),[w,C]=(0,s.useState)(0),[S,N]=(0,s.useState)(10),[L,F]=(0,s.useState)(1),[R,I]=(0,s.useState)(10),[E,P]=(0,s.useState)(0);(0,s.useEffect)((()=>{r&&j(r)}),[r]);const q=e=>{j(e),C(0)};(0,s.useEffect)((()=>{["user","staff","tech"].includes(e.accessLevel)?j("myRequisitions"):"superUser"===e.accessLevel?j("allRequisitions"):j("forMyAttention")}),[e]);const M=(0,s.useCallback)((async()=>{m(!0);try{let t,n;switch(d([]),p){case"myRequisitions":t=[];const s=await cn(null===e||void 0===e?void 0:e._id,w,S);t=s.data.requisitions,n=s.data.totalCount;break;case"forMyAttention":t=[];const i=await((e,t,n)=>g(t&&n?"attention/".concat(e,"?page=").concat(t,"&limit=").concat(n):"".concat(rn,"/attention/").concat(e)))(null===e||void 0===e?void 0:e.email,w,S);t=i.data.requisitions,n=i.data.totalCount;break;case"allRequisitions":t=[];const a=await((e,t)=>g(e&&t?"".concat(rn,"?page=").concat(e,"&limit=").concat(t):rn))(w,S);t=a.data.requisitions,n=a.data.totalCount;break;default:t=[],n=0}l(t),x(n)}catch(G){console.error("Error fetching requisitions:",G)}finally{m(!1)}}),[p,e,w,S]);(0,s.useEffect)((()=>{M()}),[p,e,M,w,S]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"xl",children:(0,k.jsxs)(Et.Ay,{container:!0,spacing:3,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between"},children:[(0,k.jsx)(ve.A,{variant:"h6",component:"div",gutterBottom:!0,children:"Requisitions"}),(0,k.jsx)(je.A,{children:["user","staff","tech"].includes(e.accessLevel)&&(0,k.jsx)(k.Fragment,{children:null!==e&&void 0!==e&&e.signatureUrl?(0,k.jsxs)(Se.A,{size:"small",variant:"outlined",color:"success",onClick:()=>{b(!1),v(!0)},sx:{ml:2},children:[(0,k.jsx)($s.A,{}),"\xa0 New Request"]}):(0,k.jsx)(Se.A,{href:"/profile",startIcon:(0,k.jsx)(Ks.A,{}),color:"warning",children:"Upload your Signature to raise request"})})}),(0,k.jsx)(ws,{open:A,onClose:()=>{b(!1),v(!1),M()},isEditMode:f,requisitionData:y||null})]}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsx)(Re.A,{})}),(0,k.jsx)(Et.Ay,{item:!0,xs:12,children:(0,k.jsx)(Js,{setLoading:m,filteredLimit:R,filteredPage:L,setFilteredTotalCount:P,setFilteredRequisitions:d})}),(0,k.jsxs)(Et.Ay,{item:!0,xs:12,children:[(0,k.jsxs)("div",{style:{display:"flex"},children:[["user","staff","tech"].includes(e.accessLevel)&&(0,k.jsx)(Qs,{isActive:"myRequisitions"===p,value:"myRequisitions",onClick:()=>q("myRequisitions"),label:"My Requisitions"}),"user"!==e.accessLevel&&"superUser"!==e.accessLevel&&(0,k.jsx)(Qs,{isActive:"forMyAttention"===p,value:"forMyAttention",onClick:()=>q("forMyAttention"),label:"Requisitions for my attention"}),"user"!==e.accessLevel&&"budgetHolder"!==e.accessLevel&&(0,k.jsx)(Qs,{isActive:"allRequisitions"===p,value:"allRequisitions",onClick:()=>q("allRequisitions"),label:"All Requisitions"})]}),"allRequisitions"===p&&(0,k.jsxs)(k.Fragment,{children:["finance"===e.accessLevel&&(0,k.jsxs)(cs.A,{severity:"info",onClose:()=>{},children:[(0,k.jsx)(ds.A,{children:"Hint"}),(0,k.jsx)("div",{children:"Use the 'filter requisitions' section above to filter requests that have been checked by the Budget Holder (Holder Checked), now ready for your checking"}),(0,k.jsx)("small",{children:"You are seeing this because you have Finance access"})]}),"financeReviewer"===e.accessLevel&&(0,k.jsxs)(cs.A,{severity:"info",onClose:()=>{},children:[(0,k.jsx)(ds.A,{children:"Hint"}),(0,k.jsx)("div",{children:"Use the 'filter requisitions' section above to filter requests that have been checked by the Finance (Finance Checked), now ready for your final review"}),(0,k.jsx)("small",{children:"You are seeing this because you have Finance Reviewer access"})]}),"superUser"===e.accessLevel&&(0,k.jsxs)(cs.A,{severity:"info",onClose:()=>{},children:[(0,k.jsx)(ds.A,{children:"Hint"}),(0,k.jsx)("div",{children:"Use the 'filter requisitions' section above to filter requests that have been reviewed by the Finance (Finance Reviewed), now ready for your approval"}),(0,k.jsx)("small",{children:"You are seeing this because you are an Approver"})]})]}),(0,k.jsx)(Vs,{requisitions:c.length>0?c:o,loading:h,totalCount:c.length>0?E:u,currentTab:p,setRequisitions:l,onEditRequisition:e=>{const t=o.map((t=>t._id===e._id?e:t));l(t)},updateTableData:M,reqId:i,action:a,tab:r,page:c.length>0?L:w,limit:c.length>0?R:S,onPageChange:c.length>0?(e,t)=>{F(t)}:(e,t)=>{C(t)},onLimitChange:c.length>0?e=>{I(parseInt(e.target.value,10)),F(1)}:e=>{N(parseInt(e.target.value,10)),C(0)}})]})]})})})})},ti=e=>{let{data:t=[],reloadData:n,loading:i,page:a,limit:r,totalCount:o,onPageChange:l,onLimitChange:c,updateTableData:d}=e;const[u,x]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[j,A]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1);(0,s.useEffect)((()=>{d()}),[]);const f=(0,s.useCallback)((e=>{m(e),x(!0)}),[]),b=(e,t)=>{switch(t){case"title":return null===e||void 0===e?void 0:e.title;case"amount":return"".concat(pn(null===e||void 0===e?void 0:e.currency)).concat(ue(Number(null===e||void 0===e?void 0:e.total)));case"status":return(0,k.jsx)(ve.A,{variant:"body2",sx:{color:t=>Rn[(null===e||void 0===e?void 0:e.retiredStatus)||"cancelled"]&&t.palette.text.primary,backgroundColor:t=>Rn[(null===e||void 0===e?void 0:e.retiredStatus)||"cancelled"]&&t.palette[Rn[(null===e||void 0===e?void 0:e.retiredStatus)||"cancelled"]].light,display:"inline",marginRight:"8px",padding:"4px 8px",borderRadius:"4px"},children:ce((null===e||void 0===e?void 0:e.retiredStatus)||"controlled")});case"action":return(0,k.jsxs)(je.A,{sx:{display:"flex",gap:"10px"},children:[(0,k.jsxs)(Se.A,{size:"small",onClick:()=>f(null===e||void 0===e?void 0:e._id),variant:"outlined",sx:{display:"flex",alignItems:"center",color:"text.primary",borderColor:"text.primary","&:hover":{borderColor:"primary.main",color:"primary.main"}},children:[(0,k.jsx)(js.A,{style:{width:16,height:16,marginRight:5}}),"View"]}),(0,k.jsxs)(Se.A,{size:"small",onClick:()=>(async e=>{try{const t=await on(e);g(t.data),y(!0),A(!0),n(),d()}catch(G){console.error("Error getting single requisition:",G.message)}})(null===e||void 0===e?void 0:e._id),variant:"contained",sx:{display:"flex",alignItems:"center",backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},children:[(0,k.jsx)(De.A,{style:{width:16,height:16,marginRight:5}}),"Request"]})]});default:return null}};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gt.A,{component:an.A,children:i?(0,k.jsxs)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,k.jsx)(wn.A,{color:"success"}),(0,k.jsx)(je.A,{sx:{mt:2},children:"Relax while we load your data..."})]}):(0,k.jsx)(k.Fragment,{children:0===t.length?(0,k.jsx)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,k.jsx)(je.A,{sx:{mt:2},children:"You have no pending retirements \ud83d\ude03!"})}):(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"40%"},children:"Title"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Amount"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Status"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Action"})]})}),(0,k.jsx)($t.A,{children:t.map((e=>(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:b(e,"title")}),(0,k.jsx)(Jt.A,{children:b(e,"amount")}),(0,k.jsx)(Jt.A,{children:b(e,"status")}),(0,k.jsx)(Jt.A,{children:b(e,"action")})]},null===e||void 0===e?void 0:e._id)))})]})})}),(0,k.jsx)(Kn.A,{rowsPerPageOptions:[5,10,25],component:"div",count:Number(o),rowsPerPage:r,page:a,onPageChange:l,onRowsPerPageChange:c}),(0,k.jsx)(Us,{isOpen:u,requisitionId:h,onClose:()=>{x(!1),m(null)},updateTableData:d}),(0,k.jsx)(ws,{open:j,retireMode:v,onClose:()=>{y(!1),A(!1),n()},triggerUpdateRequisition:n,isEditMode:!1,requisitionData:p})]})};var ni=n(9422);const si=e=>{let{requisitions:t,loading:n,totalCount:i,setRequisitions:a,onEditRequisition:r,updateTableData:o,reqId:l,action:c,page:d,limit:u,onPageChange:x,onLimitChange:h}=e;const[m,p]=(0,s.useState)(!1),[g,j]=(0,s.useState)(""),[A,v]=(0,s.useState)(""),[y,f]=(0,s.useState)(!1),[b,w]=(0,s.useState)(!1);(0,s.useEffect)((()=>{o()}),[]);const C=(0,s.useCallback)((e=>{j(e),f(!0)}),[]);(0,s.useEffect)((()=>{l&&"openModal"===c&&C(l)}),[l,c,C]);return(0,k.jsxs)(k.Fragment,{children:[n?(0,k.jsxs)(je.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,k.jsx)(wn.A,{color:"success"}),(0,k.jsx)(je.A,{sx:{mt:2},children:"Relax while we load your data..."})]}):(0,k.jsxs)(k.Fragment,{children:[(!t||0===(null===t||void 0===t?void 0:t.length))&&(0,k.jsx)(ve.A,{sx:{mt:2},children:"No retirement request yet \ud83d\ude03!"}),t&&(null===t||void 0===t?void 0:t.length)>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gt.A,{sx:{mt:2},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"SN"}),(0,k.jsx)(Jt.A,{sx:{width:"35%"},children:"Title"}),(0,k.jsx)(Jt.A,{sx:{width:"20%"},children:"Raised By"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Amount"}),(0,k.jsx)(Jt.A,{sx:{width:"15%"},children:"Date"}),(0,k.jsx)(Jt.A,{sx:{width:"10%"},children:"Status"}),(0,k.jsx)(Jt.A,{sx:{width:"15%","@media (max-width: 600px)":{display:"none"}},children:"Actions"})]})}),(0,k.jsx)($t.A,{children:t&&(null===t||void 0===t?void 0:t.map((e=>{var t;return(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:null!==e&&void 0!==e&&e.serialNumber?null===e||void 0===e?void 0:e.serialNumber:"N/A"}),(0,k.jsx)(Jt.A,{sx:{cursor:"pointer","&:hover":{backgroundColor:"#F3F4F6",boxShadow:"inset 0 0 5px rgba(0,0,0,0.1)"},paddingTop:"2rem"},onClick:()=>C(null===e||void 0===e?void 0:e._id),children:(0,k.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,k.jsx)(Ns.A,{label:null===e||void 0===e?void 0:e.type,style:{position:"absolute",top:"-20px",left:"0",fontSize:"10px",height:"18px",lineHeight:"18px"}}),(0,k.jsx)(Ke.A,{placement:"left-start",title:null===e||void 0===e?void 0:e.title,children:(0,k.jsx)("span",{children:Fn(null===e||void 0===e?void 0:e.title,50)})})]})}),(0,k.jsx)(Jt.A,{children:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.name}),(0,k.jsxs)(Jt.A,{children:[pn(null===e||void 0===e?void 0:e.currency),gn(Number(null===e||void 0===e?void 0:e.total))]}),(0,k.jsx)(Jt.A,{children:ae(null===e||void 0===e?void 0:e.date)}),(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Ln,{color:Rn[(null===e||void 0===e?void 0:e.retiredStatus)||"controlled"],children:null===e||void 0===e?void 0:e.retiredStatus})}),(0,k.jsx)(Jt.A,{className:"animated-border",children:(0,k.jsx)(hs.A,{sx:{"& .MuiOutlinedInput-root":{border:"none"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none"},"& .MuiFilledInput-underline:after":{border:"none"},"& .MuiFilledInput-underline:before":{border:"none"},"&:hover .MuiFilledInput-underline:before":{border:"none"},"& .MuiFilledInput-underline.Mui-focused:before":{border:"none"}},IconComponent:Fs.A,renderValue:e=>(0,k.jsxs)("span",{children:[(0,k.jsx)(Fs.A,{}),e]}),children:(0,k.jsxs)(xt.A,{sx:{border:"none"},children:[(0,k.jsx)(Ke.A,{placement:"left-start",title:"View details",children:(0,k.jsxs)(ht.A,{onClick:()=>C(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(js.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"View Details"})]})}),(0,k.jsx)(Ke.A,{placement:"left-start",title:"Messages",children:(0,k.jsxs)(ht.A,{onClick:()=>(e=>{j(e),p(!0)})(null===e||void 0===e?void 0:e._id),children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(Rs.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Messages"})]})}),(0,k.jsx)(Ke.A,{placement:"left-start",title:"Sign",children:(0,k.jsxs)(ht.A,{value:"Mark as Retired",onClick:()=>{v(null===e||void 0===e?void 0:e._id),w(!0)},children:[(0,k.jsx)(Ls.A,{sx:{width:"16px",height:"16px"},children:(0,k.jsx)(ni.A,{})}),(0,k.jsx)(rt.A,{primaryTypographyProps:{fontSize:"small"},primary:"Mark as Retired"})]})})]})})})]},null===e||void 0===e?void 0:e._id)})))})]})}),(0,k.jsx)(Kn.A,{rowsPerPageOptions:[5,10,25],component:"div",count:Number(i),rowsPerPage:u,page:d,onPageChange:x,onRowsPerPageChange:h})]})]}),(0,k.jsx)(zs,{open:m,onClose:()=>{j(""),p(!1)},reqId:g}),(0,k.jsx)(Ws,{open:b,onClose:()=>w(!1),title:"Mark Requisition as Retired",content:"Are you sure you want to mark this requisition as retired?",onConfirm:async()=>{try{200===(await hn(A)).status&&(o(),ne.oR.success("Requisition marked as retired."),w(!1))}catch(G){console.log("Error marking requisition as retired:",G.message),ne.oR.error("An error occurred. Please try again.")}}}),(0,k.jsx)(Us,{isOpen:y,requisitionId:g,onClose:()=>{f(!1),j("")},isRetirement:!0,updateTableData:o})]})},ii=()=>{Ct();const{user:e}=Ge(),t=(0,ge.zy)(),n=new URLSearchParams(t.search),i=n.get("id"),a=n.get("action"),[r,o]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)([]),[x,h]=(0,s.useState)(!1),[m,p]=(0,s.useState)(0),[j,A]=(0,s.useState)(10),[v,y]=(0,s.useState)(0),[f,b]=(0,s.useState)(0),[w,C]=(0,s.useState)(10),[S,N]=(0,s.useState)(0),L=(0,s.useCallback)((async()=>{h(!0);try{const e=await((e,t)=>g(e&&t?"finance-requested/retirements?page=".concat(e,"&limit=").concat(t):"finance-requested/retirements"))(f,w),{requisitions:t,totalCount:n}=e.data;u(t),N(n),h(!1)}catch(G){h(!1),console.error("Error fetching retirements:",G.message)}}),[f,w]),F=(0,s.useCallback)((async()=>{c(!0);try{const t=await dn(null===e||void 0===e?void 0:e.email,m,j),{requisitions:n,totalCount:s}=t.data;o(n),y(s),c(!1)}catch(G){c(!1),console.error("Error fetching unretired requisitions:",G.message)}}),[null===e||void 0===e?void 0:e.email,m,j]);(0,s.useEffect)((()=>{F()}),[F]),(0,s.useEffect)((()=>{L()}),[L]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"lg",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsx)(ve.A,{variant:"h5",children:"Retirements"}),(0,k.jsx)(k.Fragment,{children:["financeReviewer","finance"].includes(e.accessLevel)?(0,k.jsx)(si,{requisitions:d,updateTableData:L,loading:x,page:f,limit:w,onLimitChange:e=>{C(parseInt(e.target.value,10)),b(0)},onPageChange:(e,t)=>{b(t)},totalCount:S,reqId:i,action:a}):(0,k.jsx)(ti,{data:r,reloadData:F,loading:l,page:m,limit:j,onLimitChange:e=>{A(parseInt(e.target.value,10)),p(0)},onPageChange:(e,t)=>{p(t)},totalCount:v,updateTableData:L})})]})})})})};var ai=n(2597),ri=n(2060),oi=n(7309),li=n(3691),ci=n(1261);const di=e=>{const{company:t}=e;return(0,k.jsxs)(Cn.A,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,k.jsxs)(Hn.A,{children:[(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center",pb:3},children:(0,k.jsx)(et.A,{src:t.logo,variant:"square"})}),(0,k.jsx)(ve.A,{align:"center",gutterBottom:!0,variant:"h5",children:t.title}),(0,k.jsx)(ve.A,{align:"center",variant:"body1",children:t.description})]}),(0,k.jsx)(je.A,{sx:{flexGrow:1}}),(0,k.jsx)(Re.A,{}),(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{p:2},children:[(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,k.jsx)(_e.A,{color:"action",fontSize:"small",children:(0,k.jsx)(ci.A,{})}),(0,k.jsx)(ve.A,{color:"text.secondary",display:"inline",variant:"body2",children:"Updated 2hr ago"})]}),(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,k.jsx)(_e.A,{color:"action",fontSize:"small",children:(0,k.jsx)(ri.A,{})}),(0,k.jsxs)(ve.A,{color:"text.secondary",display:"inline",variant:"body2",children:[t.downloads," Downloads"]})]})]})]})};var ui=n(9700),xi=n(4050),hi=n(1787);const mi=()=>(0,k.jsx)(Cn.A,{sx:{p:2},children:(0,k.jsx)(xi.A,{defaultValue:"",fullWidth:!0,placeholder:"Search company",startAdornment:(0,k.jsx)(hi.A,{position:"start",children:(0,k.jsx)(_e.A,{color:"action",fontSize:"small",children:(0,k.jsx)(ui.A,{})})}),sx:{maxWidth:500}})}),pi=[{id:"2569ce0d517a7f06d3ea1f24",createdAt:"27/03/2019",description:"Dropbox is a file hosting service that offers cloud storage, file synchronization, a personal cloud.",logo:"/assets/logos/logo-dropbox.png",title:"Dropbox",downloads:"594"},{id:"ed2b900870ceba72d203ec15",createdAt:"31/03/2019",description:"Medium is an online publishing platform developed by Evan Williams, and launched in August 2012.",logo:"/assets/logos/logo-medium.png",title:"Medium Corporation",downloads:"625"},{id:"a033e38768c82fca90df3db7",createdAt:"03/04/2019",description:"Slack is a cloud-based set of team collaboration tools and services, founded by Stewart Butterfield.",logo:"/assets/logos/logo-slack.png",title:"Slack",downloads:"857"},{id:"1efecb2bf6a51def9869ab0f",createdAt:"04/04/2019",description:"Lyft is an on-demand transportation company based in San Francisco, California.",logo:"/assets/logos/logo-lyft.png",title:"Lyft",downloads:"406"},{id:"1ed68149f65fbc6089b5fd07",createdAt:"04/04/2019",description:"GitHub is a web-based hosting service for version control of code using Git.",logo:"/assets/logos/logo-github.png",title:"GitHub",downloads:"835"},{id:"5dab321376eff6177407e887",createdAt:"04/04/2019",description:"Squarespace provides software as a service for website building and hosting. Headquartered in NYC.",logo:"/assets/logos/logo-squarespace.png",title:"Squarespace",downloads:"835"}],gi=()=>(Ct(),(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"xl",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsxs)(Ie.A,{direction:"row",justifyContent:"space-between",spacing:4,children:[(0,k.jsxs)(Ie.A,{spacing:1,children:[(0,k.jsx)(ve.A,{variant:"h4",children:"Companies"}),(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:1,children:[(0,k.jsx)(Se.A,{color:"inherit",startIcon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(ai.A,{})}),children:"Import"}),(0,k.jsx)(Se.A,{color:"inherit",startIcon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(ri.A,{})}),children:"Export"})]})]}),(0,k.jsx)("div",{children:(0,k.jsx)(Se.A,{startIcon:(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(oi.A,{})}),variant:"contained",children:"Add"})})]}),(0,k.jsx)(mi,{}),(0,k.jsx)(Ae.A,{container:!0,spacing:3,children:pi.map((e=>(0,k.jsx)(Ae.A,{xs:12,md:6,lg:4,children:(0,k.jsx)(di,{company:e})},e.id)))}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"center"},children:(0,k.jsx)(li.A,{count:3,size:"small"})})]})})})}));var ji=n(7566);const Ai=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\s+/," ").split(" ").slice(0,2).map((e=>e&&e[0].toUpperCase())).join("")};var vi=n(4783);const yi=e=>{const{count:t=0,members:n=[],onPageChange:i=(()=>{}),onRowsPerPageChange:a,page:r=0,rowsPerPage:o=0,isAlumni:l=!1,onDeactivate:c,activateHandler:d,onChangeRole:u,setActiveMembers:x,updateHandler:h}=e,{user:m}=Ge(),[p,g]=(0,s.useState)({}),[j,A]=(0,s.useState)({}),[v]=(0,s.useState)("");return(0,k.jsxs)(Cn.A,{children:[(0,k.jsx)(Me,{children:(0,k.jsx)(je.A,{sx:{minWidth:800},children:(0,k.jsxs)(Yt.A,{children:[(0,k.jsx)(Zt.A,{children:(0,k.jsxs)(Xt.A,{children:[(0,k.jsx)(Jt.A,{children:"Name"}),(0,k.jsx)(Jt.A,{children:"Email"}),!l&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Jt.A,{children:"Phone"}),(0,k.jsx)(Jt.A,{children:"Access Level"})]}),m&&["tech","userManagaer"].includes(m.accessLevel)&&(0,k.jsx)(Jt.A,{children:"Action"})]})}),(0,k.jsx)($t.A,{children:n.map((e=>(0,k.jsxs)(Xt.A,{hover:!0,children:[(0,k.jsx)(Jt.A,{children:(0,k.jsxs)(Ie.A,{alignItems:"center",direction:"row",spacing:2,children:[(0,k.jsx)(et.A,{src:e.photoUrl||"",children:Ai(e.name)}),(0,k.jsx)(ve.A,{variant:"subtitle2",children:e.name})]})}),(0,k.jsx)(Jt.A,{children:e.email||"N/A"}),!l&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Jt.A,{children:e.phone||"N/A"}),(0,k.jsx)(Jt.A,{children:qn[e.accessLevel]}),m&&["tech","userManagaer"].includes(m.accessLevel)&&(0,k.jsx)(Jt.A,{children:(0,k.jsxs)(Ie.A,{direction:"row",spacing:1,children:[(0,k.jsx)(Ke.A,{title:"Deactivate",children:(0,k.jsx)($e.A,{onClick:()=>(async e=>{try{g((t=>({...t,[e]:!0}))),c(e),h()}catch(G){ne.oR.error(G.message)}finally{g((t=>({...t,[e]:!1})))}})(e._id),"aria-label":"Preview",color:"error",sx:{fontSize:"1rem"},disabled:p[e._id],children:p[e._id]?(0,k.jsx)(wn.A,{size:14}):(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(vs.A,{})})})}),(0,k.jsx)(Ke.A,{title:"Change Access",placement:"left-start",children:(0,k.jsxs)(hs.A,{size:"small",sx:{"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{border:"none"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none"},"& .MuiFilledInput-underline:after":{border:"none"},"& .MuiFilledInput-underline:before":{border:"none"},"&:hover .MuiFilledInput-underline:before":{border:"none"},"& .MuiFilledInput-underline.Mui-focused:before":{border:"none"}},value:v,onChange:t=>{return n=e._id,s=t.target.value,void u(n,s);var n,s},children:[(0,k.jsx)(ht.A,{value:"superUser",children:"Super User"}),(0,k.jsx)(ht.A,{value:"userManager",children:"User Manager"}),(0,k.jsx)(ht.A,{value:"budgetHolder",children:"Budget Holder"}),(0,k.jsx)(ht.A,{value:"finance",children:"Finance"}),(0,k.jsx)(ht.A,{value:"financeReviewer",children:"Finance Reviewer"}),(0,k.jsx)(ht.A,{value:"tech",children:"Tech"}),(0,k.jsx)(ht.A,{value:"user",children:"User"})]})})]})})]}),l&&(0,k.jsx)(k.Fragment,{children:m&&["tech","userManagaer"].includes(m.accessLevel)&&(0,k.jsx)(Jt.A,{children:(0,k.jsx)(Ie.A,{direction:"row",spacing:1,children:(0,k.jsx)(Ke.A,{placement:"left-start",title:"Activate",children:(0,k.jsx)($e.A,{onClick:()=>(async e=>{try{A((t=>({...t,[e]:!0}))),d(e),h()}catch(G){ne.oR.error(G.message)}finally{A((t=>({...t,[e]:!1})))}})(e._id),"aria-label":"Preview",color:"error",sx:{fontSize:"1rem"},disabled:j[e._id],children:j[e._id]?(0,k.jsx)(wn.A,{size:14}):(0,k.jsx)(_e.A,{fontSize:"small",children:(0,k.jsx)(vi.A,{})})})})})})})]},e._id)))})]})})}),(0,k.jsx)(je.A,{sx:{display:"flex",justifyContent:"flex-end",p:2},children:(0,k.jsx)(Kn.A,{component:"div",count:t,onPageChange:i,onRowsPerPageChange:a,page:r,rowsPerPage:o,rowsPerPageOptions:[5,10,25]})})]})},fi=e=>{let{onSearchInputChange:t}=e;return(0,k.jsx)(Cn.A,{sx:{p:2},children:(0,k.jsx)(xi.A,{defaultValue:"",fullWidth:!0,placeholder:"Search members",startAdornment:(0,k.jsx)(hi.A,{position:"start",children:(0,k.jsx)(_e.A,{color:"action",fontSize:"small",children:(0,k.jsx)(ui.A,{})})}),sx:{maxWidth:500},onChange:t})})},bi=e=>{let{open:t,onClose:n,fetchActiveMembers:i,activePage:a,rowsPerPage:r}=e;const[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[u,x]=(0,s.useState)(!1);return(0,k.jsxs)(Ce.A,{open:t,onClose:n,maxWidth:"sm",fullWidth:!0,children:[(0,k.jsx)(Dt.A,{sx:{my:2},children:"Add New Member"}),(0,k.jsxs)(_t.A,{children:[(0,k.jsx)(us.A,{fullWidth:!0,children:(0,k.jsx)(Rt.A,{value:o,onChange:e=>l(e.target.value),fullWidth:!0,label:"User Name",variant:"outlined",margin:"normal"})}),(0,k.jsx)(us.A,{fullWidth:!0,children:(0,k.jsx)(Rt.A,{value:c,onChange:e=>d(e.target.value),type:"email",fullWidth:!0,label:"User Email",variant:"outlined",margin:"normal"})})]}),(0,k.jsxs)(Wt.A,{children:[(0,k.jsx)(Se.A,{onClick:n,color:"primary",variant:"contained",children:"Cancel"}),(0,k.jsx)(Se.A,{onClick:async e=>{e.preventDefault();try{x(!0);const e={name:o,email:c};if(!e.name||!e.email)return x(!1),ne.oR.warning("Missing parameters");if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(e.email))return x(!1),ne.oR.warning("Invalid email format");const t=await(async e=>{try{return await p("users/create",e)}catch(G){throw new Error(G.message)}})(e);201===t.status&&(ne.oR.success("User added successfully"),i(a,r),n())}catch(G){ne.oR.error("Error adding user\n".concat(G.message)),console.log("Error adding user::",G.message)}finally{x(!1)}},color:"success",variant:"contained",disabled:u,children:u?"Adding...":"Add"})]})]})},wi=()=>{Ct();const{user:e}=Ge(),[t,n]=(0,s.useState)([]),[i,a]=(0,s.useState)(0),[r]=(0,s.useState)([]),[o,l]=(0,s.useState)(0),[c,d]=(0,s.useState)([]),[u,x]=(0,s.useState)([]),[h,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),[j,v]=(0,s.useState)(null),[y,S]=(0,s.useState)(null),[N,L]=(0,s.useState)(0),[F,R]=(0,s.useState)(0),[I,E]=(0,s.useState)(10),[P,q]=(0,s.useState)(""),[M,z]=(0,s.useState)(0),[B,H]=(0,s.useState)(!1);(0,s.useEffect)((()=>{m(!0),g(!0),v(null),S(null),D(N,I),_(F,I)}),[N,F,I]);const D=async(e,t)=>{try{const n=await f(e,t,P),{totalCount:s}=n.data;d(n.data.users),a(s)}catch(G){v(G.message)}finally{m(!1)}},_=async(e,t)=>{try{const n=await w(e,t,P),{users:s,totalCount:i}=n.data;x(s),l(i)}catch(G){S(G.message)}finally{g(!1)}},T=(0,s.useCallback)((async(e,t)=>{L(t);try{const e=await f(t,I,P),{users:n,totalCount:s}=e.data;console.log(n),d(n),a(s)}catch(G){v(G.message)}}),[I,P]),W=(0,s.useCallback)((async(e,t)=>{R(t);try{const e=await w(t,I,P),{users:n,totalCount:s}=e.data;x(n),l(s)}catch(G){S(G.message)}}),[I,P]),U=(0,s.useCallback)((e=>{E(e.target.value)}),[]),O=(0,s.useCallback)((e=>{const n=e.target.value;if(q(n.toLowerCase()),0===M){const e=t.filter((e=>e.name.toLowerCase().includes(n.toLowerCase())));d(e)}else if(1===M){const e=r.filter((e=>e.name.toLowerCase().includes(n.toLowerCase())));x(e)}}),[M,t,r]),V=async()=>{D(N,I),_(F,I)};return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(je.A,{component:"main",sx:{flexGrow:1,py:8},children:(0,k.jsx)(ft.A,{maxWidth:"xl",children:(0,k.jsxs)(Ie.A,{spacing:3,children:[(0,k.jsxs)(Et.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between"},children:[(0,k.jsx)(ve.A,{variant:"h6",children:"Staff Members"}),(0,k.jsxs)(je.A,{children:[["tech","userManager"].includes(e.accessLevel)&&(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(Se.A,{size:"small",variant:"outlined",color:"success",onClick:()=>H(!B),sx:{ml:2},children:[(0,k.jsx)(ji.A,{}),"\xa0 New Member"]})}),(0,k.jsx)(bi,{fetchActiveMembers:D,activePage:N,rowsPerPage:I,open:B,onClose:()=>H(!B)})]})]}),(0,k.jsx)(fi,{onSearchInputChange:O}),(0,k.jsxs)(Lt.A,{value:M,onChange:(e,t)=>{z(t)},children:[(0,k.jsx)(Ft.A,{label:"Active Members"}),(0,k.jsx)(Ft.A,{label:"Alumni"})]}),0===M&&(0,k.jsx)(yi,{members:c,isLoading:h,error:j,page:N,onPageChange:T,onRowsPerPageChange:U,rowsPerPage:I,activeTab:!0,count:i,onDeactivate:async e=>{try{await C(e),D(N,I),_(F,I),ne.oR.info("User has been deactivated")}catch(G){console.error(G),ne.oR.error("Failed to deactivate user")}},setActiveMembers:n,onChangeRole:async(e,t)=>{try{await(async(e,t)=>{try{return await A("change-user-access",{userId:e,accessLevel:t})}catch(G){throw new Error(G.message)}})(e,t);const s=(await b(e)).data;n((t=>t.map((t=>t._id===e?s:t)))),ne.oR.success("User access changed to: ".concat(t))}catch(G){console.error(G.message),ne.oR.error("Failed to change user access")}},updateHandler:V}),1===M&&(0,k.jsx)(yi,{members:u,isLoading:p,error:y,page:F,onPageChange:W,onRowsPerPageChange:U,activateHandler:async e=>{try{await C(e),D(N,I),_(F,I),ne.oR.info("User has been activated")}catch(G){console.error(G),ne.oR.error("Failed to activate user")}},setActiveMembers:n,rowsPerPage:I,activeTab:!1,isAlumni:!0,count:o,updateHandler:V})]})})})})},Ci=()=>(0,k.jsx)(pe.Kd,{children:(0,k.jsxs)(ge.BV,{children:[(0,k.jsx)(ge.qh,{path:"/user/login",element:(0,k.jsx)(be,{children:(0,k.jsx)(Ht,{})})}),(0,k.jsx)(ge.qh,{path:"/",element:(0,k.jsx)(vt,{children:(0,k.jsx)(Vn,{})})}),(0,k.jsx)(ge.qh,{path:"/profile",element:(0,k.jsx)(vt,{children:(0,k.jsx)($n,{})})}),(0,k.jsx)(ge.qh,{path:"/projects",element:(0,k.jsx)(vt,{children:(0,k.jsx)(ls,{})})}),(0,k.jsx)(ge.qh,{path:"/requisitions",element:(0,k.jsx)(vt,{children:(0,k.jsx)(ei,{})})}),(0,k.jsx)(ge.qh,{path:"/retirements",element:(0,k.jsx)(vt,{children:(0,k.jsx)(ii,{})})}),(0,k.jsx)(ge.qh,{path:"/members",element:(0,k.jsx)(vt,{children:(0,k.jsx)(wi,{})})}),(0,k.jsx)(ge.qh,{path:"/accounts",element:(0,k.jsx)(vt,{children:(0,k.jsx)(sn,{})})}),(0,k.jsx)(ge.qh,{path:"/vendors",element:(0,k.jsx)(vt,{children:(0,k.jsx)(gi,{})})}),(0,k.jsx)(ge.qh,{path:"/bin",element:(0,k.jsx)(vt,{children:(0,k.jsx)(vn,{})})}),(0,k.jsx)(ge.qh,{path:"*",element:(0,k.jsx)(St,{})})]})});var Si=n(431);const ki=(0,te.A)({key:"css"}),Ni=e=>{const{emotionCache:t=ki}=e,n=ee();return(0,s.useEffect)((()=>{const e=(0,i.Ay)(h,{withCredentials:!0});return e.on("ping",(e=>{console.log("Received ping: ".concat(e))})),()=>{e.disconnect()}}),[]),(0,k.jsxs)(a.C,{value:t,children:[(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(me,{})}),(0,k.jsx)(r.$,{dateAdapter:o.h,children:(0,k.jsx)(M,{children:(0,k.jsxs)(c.A,{theme:n,children:[(0,k.jsx)(l.Ay,{}),(0,k.jsx)(ne.N9,{theme:"colored"}),(0,k.jsx)(z,{children:e=>e.isLoading?(0,k.jsx)(Si.A,{}):(0,k.jsx)(Ci,{})})]})})})]})}}}]);
//# sourceMappingURL=784.df878224.chunk.js.map